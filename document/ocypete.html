<!DOCTYPE html>
<!-- Generated by Cython 0.29.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: ocypete.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.21</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="ocypete.c">ocypete.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: #cython: boundscheck=False, wraparound=False, nonecheck=False, initializedcheck=False, cdivision=True</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: from libc.math cimport exp, pow, tgamma, sqrt, abs</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: from scipy.special.cython_special cimport hyp1f1</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">005</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">006</span>: cimport numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">008</span>: cdef double pi = 3.141592653589793238462643383279</pre>
<pre class='cython code score-0 '>  __pyx_v_7ocypete_pi = 3.141592653589793238462643383279;
</pre><pre class="cython line score-0">&#xA0;<span class="">009</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: #---------------------------------------Shared Routines -----------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">012</span>: cdef double cye(int ia,int ja,int type, double r, double ie, double je, int n = 0, double x = 0.0):</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_cye(int __pyx_v_ia, int __pyx_v_ja, int __pyx_v_type, double __pyx_v_r, double __pyx_v_ie, double __pyx_v_je, struct __pyx_opt_args_7ocypete_cye *__pyx_optional_args) {
  int __pyx_v_n = ((int)0);
  double __pyx_v_x = ((double)0.0);
  double __pyx_v_p;
  double __pyx_v_q;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cye", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_n = __pyx_optional_args-&gt;n;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_x = __pyx_optional_args-&gt;x;
      }
    }
  }
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_7ocypete_cye {
  int __pyx_n;
  int n;
  double x;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: 	cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: 		double p = ie + je</pre>
<pre class='cython code score-0 '>  __pyx_v_p = (__pyx_v_ie + __pyx_v_je);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">016</span>: 		double q = ie*je / p</pre>
<pre class='cython code score-0 '>  __pyx_v_q = ((__pyx_v_ie * __pyx_v_je) / __pyx_v_p);
</pre><pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: 	if n == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_n == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>: 		if (type &lt; 0) or (type &gt; (ia + ja)):</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_type &lt; 0) != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_type &gt; (__pyx_v_ia + __pyx_v_ja)) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L5_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">020</span>: 			return 0.0</pre>
<pre class='cython code score-0 '>      __pyx_r = 0.0;
      goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">021</span>: 		elif (ia + ja + type) == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((((__pyx_v_ia + __pyx_v_ja) + __pyx_v_type) == 0) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>: 			return exp(-q*r*r)</pre>
<pre class='cython code score-0 '>      __pyx_r = exp((((-__pyx_v_q) * __pyx_v_r) * __pyx_v_r));
      goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>: 		elif ja == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_ja == 0) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">024</span>: 			return (1/(2 * p)) * cye(ia-1,ja,type-1,r,ie,je) - (q*r/ie) * cye(ia-1,ja,type,r,ie,je) + \</pre>
<pre class='cython code score-0 '>      __pyx_r = ((((1.0 / (2.0 * __pyx_v_p)) * __pyx_f_7ocypete_cye((__pyx_v_ia - 1), __pyx_v_ja, (__pyx_v_type - 1), __pyx_v_r, __pyx_v_ie, __pyx_v_je, NULL)) - (((__pyx_v_q * __pyx_v_r) / __pyx_v_ie) * __pyx_f_7ocypete_cye((__pyx_v_ia - 1), __pyx_v_ja, __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, NULL))) + ((__pyx_v_type + 1) * __pyx_f_7ocypete_cye((__pyx_v_ia - 1), __pyx_v_ja, (__pyx_v_type + 1), __pyx_v_r, __pyx_v_ie, __pyx_v_je, NULL)));
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">025</span>:                          (type+1) * cye(ia-1,ja,type+1,r,ie,je)</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: 		else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>: 			return (1/(2 * p)) * cye(ia,ja-1,type-1,r,ie,je) + (q*r/je) * cye(ia,ja-1,type,r,ie,je) + \</pre>
<pre class='cython code score-0 '>    /*else*/ {
/* … */
      __pyx_r = ((((1.0 / (2.0 * __pyx_v_p)) * __pyx_f_7ocypete_cye(__pyx_v_ia, (__pyx_v_ja - 1), (__pyx_v_type - 1), __pyx_v_r, __pyx_v_ie, __pyx_v_je, NULL)) + (((__pyx_v_q * __pyx_v_r) / __pyx_v_je) * __pyx_f_7ocypete_cye(__pyx_v_ia, (__pyx_v_ja - 1), __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, NULL))) + ((__pyx_v_type + 1) * __pyx_f_7ocypete_cye(__pyx_v_ia, (__pyx_v_ja - 1), (__pyx_v_type + 1), __pyx_v_r, __pyx_v_ie, __pyx_v_je, NULL)));
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">028</span>:                          (type+1) * cye(ia,ja-1,type+1,r,ie,je)</pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: 	else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>: 		return cye(ia+1,ja,type,r,ie,je,n-1,x) + x * cye(ia,ja,type,r,ie,je,n-1,x)</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n - 1);
    __pyx_t_4.x = __pyx_v_x;
    __pyx_t_3 = __pyx_f_7ocypete_cye((__pyx_v_ia + 1), __pyx_v_ja, __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n - 1);
    __pyx_t_4.x = __pyx_v_x;
    __pyx_t_5 = __pyx_f_7ocypete_cye(__pyx_v_ia, __pyx_v_ja, __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_r = (__pyx_t_3 + (__pyx_v_x * __pyx_t_5));
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>: cdef double efx(int ia,int ja,int type, double r, double ie, double je, int n = 0, double x = 0.0, int p = 0, int s = 0):</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_efx(int __pyx_v_ia, int __pyx_v_ja, int __pyx_v_type, double __pyx_v_r, double __pyx_v_ie, double __pyx_v_je, struct __pyx_opt_args_7ocypete_efx *__pyx_optional_args) {
  int __pyx_v_n = ((int)0);
  double __pyx_v_x = ((double)0.0);
  int __pyx_v_p = ((int)0);
  int __pyx_v_s = ((int)0);
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("efx", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_n = __pyx_optional_args-&gt;n;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_x = __pyx_optional_args-&gt;x;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_p = __pyx_optional_args-&gt;p;
          if (__pyx_optional_args-&gt;__pyx_n &gt; 3) {
            __pyx_v_s = __pyx_optional_args-&gt;s;
          }
        }
      }
    }
  }
/* … */
  /* function exit code */
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_7ocypete_efx {
  int __pyx_n;
  int n;
  double x;
  int p;
  int s;
};
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>: 	if p == 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_p == 1) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>: 		return 2.0 * ie * cye(ia+1, ja, type, r, ie, je, n, x) - ia * cye(ia-1, ja, type, r, ie, je, n, x)</pre>
<pre class='cython code score-0 '>    __pyx_t_3.__pyx_n = 2;
    __pyx_t_3.n = __pyx_v_n;
    __pyx_t_3.x = __pyx_v_x;
    __pyx_t_2 = __pyx_f_7ocypete_cye((__pyx_v_ia + 1), __pyx_v_ja, __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_3); 
    __pyx_t_3.__pyx_n = 2;
    __pyx_t_3.n = __pyx_v_n;
    __pyx_t_3.x = __pyx_v_x;
    __pyx_t_4 = __pyx_f_7ocypete_cye((__pyx_v_ia - 1), __pyx_v_ja, __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_3); 
    __pyx_r = (((2.0 * __pyx_v_ie) * __pyx_t_2) - (__pyx_v_ia * __pyx_t_4));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>: 	elif s == 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_s == 1) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>: 		return 2.0 * je * cye(ia, ja+1, type, r, ie, je, n, x) - ja * cye(ia, ja-1, type, r, ie, je, n, x)</pre>
<pre class='cython code score-0 '>    __pyx_t_3.__pyx_n = 2;
    __pyx_t_3.n = __pyx_v_n;
    __pyx_t_3.x = __pyx_v_x;
    __pyx_t_4 = __pyx_f_7ocypete_cye(__pyx_v_ia, (__pyx_v_ja + 1), __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_3); 
    __pyx_t_3.__pyx_n = 2;
    __pyx_t_3.n = __pyx_v_n;
    __pyx_t_3.x = __pyx_v_x;
    __pyx_t_2 = __pyx_f_7ocypete_cye(__pyx_v_ia, (__pyx_v_ja - 1), __pyx_v_type, __pyx_v_r, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_3); 
    __pyx_r = (((2.0 * __pyx_v_je) * __pyx_t_4) - (__pyx_v_ja * __pyx_t_2));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">038</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>: cdef double ovlpfx(int ia0, int ia1, int ia2, int ja0, int ja1, int ja2, double ie, double je, \</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_ovlpfx(int __pyx_v_ia0, int __pyx_v_ia1, int __pyx_v_ia2, int __pyx_v_ja0, int __pyx_v_ja1, int __pyx_v_ja2, double __pyx_v_ie, double __pyx_v_je, double __pyx_v_ir0, double __pyx_v_ir1, double __pyx_v_ir2, double __pyx_v_jr0, double __pyx_v_jr1, double __pyx_v_jr2, int *__pyx_v_n, double *__pyx_v_origin, int __pyx_v_x, int __pyx_v_center) {
  int __pyx_v_pa;
  int __pyx_v_pb;
  double __pyx_v_t;
  double __pyx_v_r0;
  double __pyx_v_r1;
  double __pyx_v_r2;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ovlpfx", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">040</span>:                    double ir0, double ir1, double ir2, double jr0, double jr1, double jr2, int[3] n, double[3] origin, int x, int center):</pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>: 	cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>: 		int pa = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_pa = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">044</span>: 		int pb</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>: 		double t = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_t = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: 		double r0, r1, r2</pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>: 	if center == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_center == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>: 		pa = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_pa = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>: 	pb = (pa+1) % 2</pre>
<pre class='cython code score-0 '>  __pyx_v_pb = ((__pyx_v_pa + 1) % 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>: 	r0 = ir0 - jr0</pre>
<pre class='cython code score-0 '>  __pyx_v_r0 = (__pyx_v_ir0 - __pyx_v_jr0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>: 	r1 = ir1 - jr1</pre>
<pre class='cython code score-0 '>  __pyx_v_r1 = (__pyx_v_ir1 - __pyx_v_jr1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>: 	r2 = ir2 - jr2</pre>
<pre class='cython code score-0 '>  __pyx_v_r2 = (__pyx_v_ir2 - __pyx_v_jr2);
</pre><pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>: 	if x == 0:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_x) {
    case 0:
/* … */
    break;
    case 1:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>: 		t =  efx(ia0, ja0 , 0, r0, ie, je, n[0], ir0 - origin[0],pa ,pb )</pre>
<pre class='cython code score-0 '>    __pyx_t_3.__pyx_n = 4;
    __pyx_t_3.n = (__pyx_v_n[0]);
    __pyx_t_3.x = (__pyx_v_ir0 - (__pyx_v_origin[0]));
    __pyx_t_3.p = __pyx_v_pa;
    __pyx_t_3.s = __pyx_v_pb;
    __pyx_t_2 = __pyx_f_7ocypete_efx(__pyx_v_ia0, __pyx_v_ja0, 0, __pyx_v_r0, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_3); 
    __pyx_v_t = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>: 		t *= cye(ia1, ja1 , 0, r1, ie, je, n[1], ir1 - origin[1])</pre>
<pre class='cython code score-0 '>    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n[1]);
    __pyx_t_4.x = (__pyx_v_ir1 - (__pyx_v_origin[1]));
    __pyx_t_2 = __pyx_f_7ocypete_cye(__pyx_v_ia1, __pyx_v_ja1, 0, __pyx_v_r1, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_v_t = (__pyx_v_t * __pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>: 		t *= cye(ia2, ja2 , 0, r2, ie, je, n[2], ir2 - origin[2])</pre>
<pre class='cython code score-0 '>    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n[2]);
    __pyx_t_4.x = (__pyx_v_ir2 - (__pyx_v_origin[2]));
    __pyx_t_2 = __pyx_f_7ocypete_cye(__pyx_v_ia2, __pyx_v_ja2, 0, __pyx_v_r2, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_v_t = (__pyx_v_t * __pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>: 	elif x == 1:</pre>
<pre class='cython code score-0 '>    break;
    case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>: 		t =  cye(ia0, ja0 , 0, r0, ie, je, n[0], ir0 - origin[0])</pre>
<pre class='cython code score-0 '>    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n[0]);
    __pyx_t_4.x = (__pyx_v_ir0 - (__pyx_v_origin[0]));
    __pyx_t_2 = __pyx_f_7ocypete_cye(__pyx_v_ia0, __pyx_v_ja0, 0, __pyx_v_r0, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_v_t = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>: 		t *= efx(ia1, ja1 , 0, r1, ie, je, n[1], ir1 - origin[1],pa ,pb )</pre>
<pre class='cython code score-0 '>    __pyx_t_3.__pyx_n = 4;
    __pyx_t_3.n = (__pyx_v_n[1]);
    __pyx_t_3.x = (__pyx_v_ir1 - (__pyx_v_origin[1]));
    __pyx_t_3.p = __pyx_v_pa;
    __pyx_t_3.s = __pyx_v_pb;
    __pyx_t_2 = __pyx_f_7ocypete_efx(__pyx_v_ia1, __pyx_v_ja1, 0, __pyx_v_r1, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_3); 
    __pyx_v_t = (__pyx_v_t * __pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>: 		t *= cye(ia2, ja2 , 0, r2, ie, je, n[2], ir2 - origin[2])</pre>
<pre class='cython code score-0 '>    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n[2]);
    __pyx_t_4.x = (__pyx_v_ir2 - (__pyx_v_origin[2]));
    __pyx_t_2 = __pyx_f_7ocypete_cye(__pyx_v_ia2, __pyx_v_ja2, 0, __pyx_v_r2, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_v_t = (__pyx_v_t * __pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>: 	elif x == 2:</pre>
<pre class='cython code score-0 '>    break;
    default: break;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>: 		t =  cye(ia0, ja0 , 0, r0, ie, je, n[0], ir0 - origin[0])</pre>
<pre class='cython code score-0 '>    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n[0]);
    __pyx_t_4.x = (__pyx_v_ir0 - (__pyx_v_origin[0]));
    __pyx_t_2 = __pyx_f_7ocypete_cye(__pyx_v_ia0, __pyx_v_ja0, 0, __pyx_v_r0, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_v_t = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">066</span>: 		t *= cye(ia1, ja1 , 0, r1, ie, je, n[1], ir1 - origin[1])</pre>
<pre class='cython code score-0 '>    __pyx_t_4.__pyx_n = 2;
    __pyx_t_4.n = (__pyx_v_n[1]);
    __pyx_t_4.x = (__pyx_v_ir1 - (__pyx_v_origin[1]));
    __pyx_t_2 = __pyx_f_7ocypete_cye(__pyx_v_ia1, __pyx_v_ja1, 0, __pyx_v_r1, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
    __pyx_v_t = (__pyx_v_t * __pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>: 		t *= efx(ia2, ja2 , 0, r2, ie, je, n[2], ir2 - origin[2],pa ,pb )</pre>
<pre class='cython code score-0 '>    __pyx_t_3.__pyx_n = 4;
    __pyx_t_3.n = (__pyx_v_n[2]);
    __pyx_t_3.x = (__pyx_v_ir2 - (__pyx_v_origin[2]));
    __pyx_t_3.p = __pyx_v_pa;
    __pyx_t_3.s = __pyx_v_pb;
    __pyx_t_2 = __pyx_f_7ocypete_efx(__pyx_v_ia2, __pyx_v_ja2, 0, __pyx_v_r2, __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_3); 
    __pyx_v_t = (__pyx_v_t * __pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">068</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>: 	return t * pow(pi/(ie+je), 1.5)</pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_t * pow((__pyx_v_7ocypete_pi / (__pyx_v_ie + __pyx_v_je)), 1.5));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">070</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">071</span>: cdef double kntcfx(int[3] ia, int[3] ja, double ie, double je, double[3] ir, double[3] jr, \</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_kntcfx(int *__pyx_v_ia, int *__pyx_v_ja, double __pyx_v_ie, double __pyx_v_je, double *__pyx_v_ir, double *__pyx_v_jr, int *__pyx_v_n, double *__pyx_v_origin, int __pyx_v_x, int __pyx_v_center) {
  int __pyx_v_pa;
  int __pyx_v_pb;
  int __pyx_v_i;
  double __pyx_v_t[3];
  double __pyx_v_mu[3];
  double __pyx_v_nu[3];
  double __pyx_v_vu[3];
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("kntcfx", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">072</span>:                int[3] n, double[3] origin, int x, int center):</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: 	#cases for center 'a' and center 'b'</pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: 	cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">076</span>: 		int pa = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_pa = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">077</span>: 		int pb, i</pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: 		double[3] t</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: 		double[3] mu, nu, vu</pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>: 	if center == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_center == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>: 		pa = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_pa = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>: 	pb = (pa+1) % 2</pre>
<pre class='cython code score-0 '>  __pyx_v_pb = ((__pyx_v_pa + 1) % 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">084</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>: 	for i in range(0, 3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_2 = 0; __pyx_t_2 &lt; 3; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>: 		mu[i] = (2*ja[i] + 1) * je</pre>
<pre class='cython code score-0 '>    (__pyx_v_mu[__pyx_v_i]) = (((2 * (__pyx_v_ja[__pyx_v_i])) + 1) * __pyx_v_je);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>: 		nu[i] = -2*pow(je,2)</pre>
<pre class='cython code score-0 '>    (__pyx_v_nu[__pyx_v_i]) = (-2.0 * pow(__pyx_v_je, 2.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>: 		vu[i] = -0.5 * ja[i]* (ja[i]-1)</pre>
<pre class='cython code score-0 '>    (__pyx_v_vu[__pyx_v_i]) = ((-0.5 * (__pyx_v_ja[__pyx_v_i])) * ((__pyx_v_ja[__pyx_v_i]) - 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>: 		t[i] = 0.0</pre>
<pre class='cython code score-0 '>    (__pyx_v_t[__pyx_v_i]) = 0.0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">090</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">091</span>: 	for i in range(0, 3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_2 = 0; __pyx_t_2 &lt; 3; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">092</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>: 		if i == x:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_i == __pyx_v_x) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L8;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>: 			t[x] = mu[x] * efx(ia[x], ja[x] , 0, ir[x] - jr[x], ie, je, n[x], ir[x] - origin[x],pa ,pb ) + \</pre>
<pre class='cython code score-0 '>      __pyx_t_4.__pyx_n = 4;
      __pyx_t_4.n = (__pyx_v_n[__pyx_v_x]);
      __pyx_t_4.x = ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_origin[__pyx_v_x]));
      __pyx_t_4.p = __pyx_v_pa;
      __pyx_t_4.s = __pyx_v_pb;
      __pyx_t_3 = __pyx_f_7ocypete_efx((__pyx_v_ia[__pyx_v_x]), (__pyx_v_ja[__pyx_v_x]), 0, ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_jr[__pyx_v_x])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
/* … */
      (__pyx_v_t[__pyx_v_x]) = ((((__pyx_v_mu[__pyx_v_x]) * __pyx_t_3) + ((__pyx_v_nu[__pyx_v_x]) * __pyx_t_5)) + ((__pyx_v_vu[__pyx_v_x]) * __pyx_t_6));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>: 			       nu[x] * efx(ia[x], ja[x] + 2 , 0, ir[x] - jr[x], ie, je, n[x], ir[x] - origin[x],pa ,pb ) + \</pre>
<pre class='cython code score-0 '>      __pyx_t_4.__pyx_n = 4;
      __pyx_t_4.n = (__pyx_v_n[__pyx_v_x]);
      __pyx_t_4.x = ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_origin[__pyx_v_x]));
      __pyx_t_4.p = __pyx_v_pa;
      __pyx_t_4.s = __pyx_v_pb;
      __pyx_t_5 = __pyx_f_7ocypete_efx((__pyx_v_ia[__pyx_v_x]), ((__pyx_v_ja[__pyx_v_x]) + 2), 0, ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_jr[__pyx_v_x])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>: 				   vu[x] * efx(ia[x], ja[x] - 2, 0, ir[x] - jr[x], ie, je, n[x], ir[x] - origin[x],pa ,pb )</pre>
<pre class='cython code score-0 '>      __pyx_t_4.__pyx_n = 4;
      __pyx_t_4.n = (__pyx_v_n[__pyx_v_x]);
      __pyx_t_4.x = ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_origin[__pyx_v_x]));
      __pyx_t_4.p = __pyx_v_pa;
      __pyx_t_4.s = __pyx_v_pb;
      __pyx_t_6 = __pyx_f_7ocypete_efx((__pyx_v_ia[__pyx_v_x]), ((__pyx_v_ja[__pyx_v_x]) - 2), 0, ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_jr[__pyx_v_x])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
</pre><pre class="cython line score-0">&#xA0;<span class="">097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: 		else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>: 			t[i] = mu[i] * cye(ia[i], ja[i] , 0, ir[i] - jr[i], ie, je, n[i], ir[i] - origin[i]) + \</pre>
<pre class='cython code score-0 '>      __pyx_t_7.__pyx_n = 2;
      __pyx_t_7.n = (__pyx_v_n[__pyx_v_i]);
      __pyx_t_7.x = ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_origin[__pyx_v_i]));
      __pyx_t_6 = __pyx_f_7ocypete_cye((__pyx_v_ia[__pyx_v_i]), (__pyx_v_ja[__pyx_v_i]), 0, ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_jr[__pyx_v_i])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_7); 
/* … */
      (__pyx_v_t[__pyx_v_i]) = ((((__pyx_v_mu[__pyx_v_i]) * __pyx_t_6) + ((__pyx_v_nu[__pyx_v_i]) * __pyx_t_5)) + ((__pyx_v_vu[__pyx_v_i]) * __pyx_t_3));
    }
    __pyx_L8:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>: 				   nu[i] * cye(ia[i], ja[i] + 2, 0, ir[i] - jr[i], ie, je, n[i], ir[i] - origin[i]) + \</pre>
<pre class='cython code score-0 '>    /*else*/ {
/* … */
      __pyx_t_7.__pyx_n = 2;
      __pyx_t_7.n = (__pyx_v_n[__pyx_v_i]);
      __pyx_t_7.x = ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_origin[__pyx_v_i]));
      __pyx_t_5 = __pyx_f_7ocypete_cye((__pyx_v_ia[__pyx_v_i]), ((__pyx_v_ja[__pyx_v_i]) + 2), 0, ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_jr[__pyx_v_i])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_7); 
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>: 				   vu[i] * cye(ia[i], ja[i] - 2, 0, ir[i] - jr[i], ie, je, n[i], ir[i] - origin[i])</pre>
<pre class='cython code score-0 '>      __pyx_t_7.__pyx_n = 2;
      __pyx_t_7.n = (__pyx_v_n[__pyx_v_i]);
      __pyx_t_7.x = ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_origin[__pyx_v_i]));
      __pyx_t_3 = __pyx_f_7ocypete_cye((__pyx_v_ia[__pyx_v_i]), ((__pyx_v_ja[__pyx_v_i]) - 2), 0, ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_jr[__pyx_v_i])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_7); 
</pre><pre class="cython line score-0">&#xA0;<span class="">102</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>: 	for i in range(0, 3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_2 = 0; __pyx_t_2 &lt; 3; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">104</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">105</span>: 		if i == x:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_i == __pyx_v_x) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>: 			t[(x+1) % 3] *= efx(ia[x], ja[x] , 0, ir[x] - jr[x], ie, je, n[x], ir[x] - origin[x],pa ,pb )</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = ((__pyx_v_x + 1) % 3);
      __pyx_t_4.__pyx_n = 4;
      __pyx_t_4.n = (__pyx_v_n[__pyx_v_x]);
      __pyx_t_4.x = ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_origin[__pyx_v_x]));
      __pyx_t_4.p = __pyx_v_pa;
      __pyx_t_4.s = __pyx_v_pb;
      __pyx_t_3 = __pyx_f_7ocypete_efx((__pyx_v_ia[__pyx_v_x]), (__pyx_v_ja[__pyx_v_x]), 0, ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_jr[__pyx_v_x])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
      (__pyx_v_t[__pyx_t_8]) = ((__pyx_v_t[__pyx_t_8]) * __pyx_t_3);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>: 			t[(x+2) % 3] *= efx(ia[x], ja[x] , 0, ir[x] - jr[x], ie, je, n[x], ir[x] - origin[x],pa ,pb )</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = ((__pyx_v_x + 2) % 3);
      __pyx_t_4.__pyx_n = 4;
      __pyx_t_4.n = (__pyx_v_n[__pyx_v_x]);
      __pyx_t_4.x = ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_origin[__pyx_v_x]));
      __pyx_t_4.p = __pyx_v_pa;
      __pyx_t_4.s = __pyx_v_pb;
      __pyx_t_3 = __pyx_f_7ocypete_efx((__pyx_v_ia[__pyx_v_x]), (__pyx_v_ja[__pyx_v_x]), 0, ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_jr[__pyx_v_x])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_4); 
      (__pyx_v_t[__pyx_t_8]) = ((__pyx_v_t[__pyx_t_8]) * __pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">108</span>: 		else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>: 			t[(i+1) % 3] *= cye(ia[i], ja[i], 0, ir[i] - jr[i], ie, je, n[i], ir[i] - origin[i])</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_8 = ((__pyx_v_i + 1) % 3);
      __pyx_t_7.__pyx_n = 2;
      __pyx_t_7.n = (__pyx_v_n[__pyx_v_i]);
      __pyx_t_7.x = ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_origin[__pyx_v_i]));
      __pyx_t_3 = __pyx_f_7ocypete_cye((__pyx_v_ia[__pyx_v_i]), (__pyx_v_ja[__pyx_v_i]), 0, ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_jr[__pyx_v_i])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_7); 
      (__pyx_v_t[__pyx_t_8]) = ((__pyx_v_t[__pyx_t_8]) * __pyx_t_3);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>: 			t[(i+2) % 3] *= cye(ia[i], ja[i], 0, ir[i] - jr[i], ie, je, n[i], ir[i] - origin[i])</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = ((__pyx_v_i + 2) % 3);
      __pyx_t_7.__pyx_n = 2;
      __pyx_t_7.n = (__pyx_v_n[__pyx_v_i]);
      __pyx_t_7.x = ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_origin[__pyx_v_i]));
      __pyx_t_3 = __pyx_f_7ocypete_cye((__pyx_v_ia[__pyx_v_i]), (__pyx_v_ja[__pyx_v_i]), 0, ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_jr[__pyx_v_i])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_7); 
      (__pyx_v_t[__pyx_t_8]) = ((__pyx_v_t[__pyx_t_8]) * __pyx_t_3);
    }
    __pyx_L11:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">111</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>: 	return (t[0] + t[1] + t[2]) * pow(pi/(ie+je), 1.5)</pre>
<pre class='cython code score-0 '>  __pyx_r = ((((__pyx_v_t[0]) + (__pyx_v_t[1])) + (__pyx_v_t[2])) * pow((__pyx_v_7ocypete_pi / (__pyx_v_ie + __pyx_v_je)), 1.5));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">113</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>: cdef double boys(double m,double T):</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_boys(double __pyx_v_m, double __pyx_v_T) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("boys", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>: 	return hyp1f1(m+0.5,m+1.5,-T)/(2.0*m+1.0)</pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_hyp1f1((__pyx_v_m + 0.5), (__pyx_v_m + 1.5), (-__pyx_v_T), 0) / ((2.0 * __pyx_v_m) + 1.0));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">116</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>: cdef double clmb(int l, int m, int n, int bf, double p, double r0, double r1, double r2):</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_clmb(int __pyx_v_l, int __pyx_v_m, int __pyx_v_n, int __pyx_v_bf, double __pyx_v_p, double __pyx_v_r0, double __pyx_v_r1, double __pyx_v_r2) {
  double __pyx_v_t;
  double __pyx_v_s;
  double __pyx_v_nm;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clmb", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>: 	cdef double t, s, nm</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>: 	nm = sqrt(r0*r0 + r1*r1 + r2*r2)</pre>
<pre class='cython code score-0 '>  __pyx_v_nm = sqrt((((__pyx_v_r0 * __pyx_v_r0) + (__pyx_v_r1 * __pyx_v_r1)) + (__pyx_v_r2 * __pyx_v_r2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>: 	t = p * nm * nm</pre>
<pre class='cython code score-0 '>  __pyx_v_t = ((__pyx_v_p * __pyx_v_nm) * __pyx_v_nm);
</pre><pre class="cython line score-0">&#xA0;<span class="">122</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>: 	s = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_s = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>: 	if (l+m+n)  == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((__pyx_v_l + __pyx_v_m) + __pyx_v_n) == 0) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>: 		s += pow(-2*p, bf) * boys(bf, t)</pre>
<pre class='cython code score-0 '>    __pyx_v_s = (__pyx_v_s + (pow((-2.0 * __pyx_v_p), __pyx_v_bf) * __pyx_f_7ocypete_boys(__pyx_v_bf, __pyx_v_t)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>: 	elif (l+m) == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_l + __pyx_v_m) == 0) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>: 		if n &gt; 1:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_n &gt; 1) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>: 			s +=(n-1) * clmb(l,m,n-2,bf+1,p,r0,r1,r2)</pre>
<pre class='cython code score-0 '>      __pyx_v_s = (__pyx_v_s + ((__pyx_v_n - 1) * __pyx_f_7ocypete_clmb(__pyx_v_l, __pyx_v_m, (__pyx_v_n - 2), (__pyx_v_bf + 1), __pyx_v_p, __pyx_v_r0, __pyx_v_r1, __pyx_v_r2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>: 		s += r2 * clmb(l,m,n-1,bf+1,p,r0,r1,r2)</pre>
<pre class='cython code score-0 '>    __pyx_v_s = (__pyx_v_s + (__pyx_v_r2 * __pyx_f_7ocypete_clmb(__pyx_v_l, __pyx_v_m, (__pyx_v_n - 1), (__pyx_v_bf + 1), __pyx_v_p, __pyx_v_r0, __pyx_v_r1, __pyx_v_r2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>: 	elif l == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_l == 0) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>: 		if m &gt; 1:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_m &gt; 1) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>: 			s +=(m-1) * clmb(l,m-2,n,bf+1,p,r0,r1,r2)</pre>
<pre class='cython code score-0 '>      __pyx_v_s = (__pyx_v_s + ((__pyx_v_m - 1) * __pyx_f_7ocypete_clmb(__pyx_v_l, (__pyx_v_m - 2), __pyx_v_n, (__pyx_v_bf + 1), __pyx_v_p, __pyx_v_r0, __pyx_v_r1, __pyx_v_r2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>: 		s += r1 * clmb(l,m-1,n,bf+1,p,r0,r1,r2)</pre>
<pre class='cython code score-0 '>    __pyx_v_s = (__pyx_v_s + (__pyx_v_r1 * __pyx_f_7ocypete_clmb(__pyx_v_l, (__pyx_v_m - 1), __pyx_v_n, (__pyx_v_bf + 1), __pyx_v_p, __pyx_v_r0, __pyx_v_r1, __pyx_v_r2)));
</pre><pre class="cython line score-0">&#xA0;<span class="">134</span>: 	else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>: 		if l &gt; 1:</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_1 = ((__pyx_v_l &gt; 1) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>: 			s +=(l-1) * clmb(l-2,m,n,bf+1,p,r0,r1,r2)</pre>
<pre class='cython code score-0 '>      __pyx_v_s = (__pyx_v_s + ((__pyx_v_l - 1) * __pyx_f_7ocypete_clmb((__pyx_v_l - 2), __pyx_v_m, __pyx_v_n, (__pyx_v_bf + 1), __pyx_v_p, __pyx_v_r0, __pyx_v_r1, __pyx_v_r2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>: 		s += r0 * clmb(l-1,m,n,bf+1,p,r0,r1,r2)</pre>
<pre class='cython code score-0 '>    __pyx_v_s = (__pyx_v_s + (__pyx_v_r0 * __pyx_f_7ocypete_clmb((__pyx_v_l - 1), __pyx_v_m, __pyx_v_n, (__pyx_v_bf + 1), __pyx_v_p, __pyx_v_r0, __pyx_v_r1, __pyx_v_r2)));
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>: 	return s</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_s;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">140</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>: cdef double clmbsfx(int[3] ia, int[3] ja, double ie, double je, double[3] ir, double[3] jr, \</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_clmbsfx(int *__pyx_v_ia, int *__pyx_v_ja, double __pyx_v_ie, double __pyx_v_je, double *__pyx_v_ir, double *__pyx_v_jr, __Pyx_memviewslice __pyx_v_nucleus, int *__pyx_v_n, CYTHON_UNUSED double *__pyx_v_origin, int __pyx_v_x, int __pyx_v_center) {
  double __pyx_v_p;
  double __pyx_v_q[3];
  double __pyx_v_r[3];
  int __pyx_v_i;
  int __pyx_v_mu;
  int __pyx_v_nu;
  int __pyx_v_vu;
  int __pyx_v_pa;
  int __pyx_v_pb;
  int __pyx_v_tau[3];
  double __pyx_v_sum;
  double __pyx_v_val;
  int __pyx_v_xi[3];
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clmbsfx", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">142</span>:                double[:] nucleus, int[3] n, double[3] origin, int x, int center):</pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>: 	#generalised coulomb derivatives dV(ab^(0,0,0))/dx terms</pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>: 	cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>: 		double p = ie + je</pre>
<pre class='cython code score-0 '>  __pyx_v_p = (__pyx_v_ie + __pyx_v_je);
</pre><pre class="cython line score-0">&#xA0;<span class="">147</span>: 		double[3] q, r</pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>: 		int i, mu, nu, vu, pa, pb</pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>: 		int tau[3]</pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>: 		double sum, val</pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>: 		int[3] xi</pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>: 	for i in range(0, 3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>: 		q[i] = (ie*ir[i] + je*jr[i])/p</pre>
<pre class='cython code score-0 '>    (__pyx_v_q[__pyx_v_i]) = (((__pyx_v_ie * (__pyx_v_ir[__pyx_v_i])) + (__pyx_v_je * (__pyx_v_jr[__pyx_v_i]))) / __pyx_v_p);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>: 		tau[i] = ia[i] + ja[i] + n[i] + 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_tau[__pyx_v_i]) = ((((__pyx_v_ia[__pyx_v_i]) + (__pyx_v_ja[__pyx_v_i])) + (__pyx_v_n[__pyx_v_i])) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>: 		r[i] = q[i] - nucleus[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_i;
    (__pyx_v_r[__pyx_v_i]) = ((__pyx_v_q[__pyx_v_i]) - (*((double *) ( /* dim=0 */ (__pyx_v_nucleus.data + __pyx_t_2 * __pyx_v_nucleus.strides[0]) ))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>: 	tau[x] += 1</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_x;
  (__pyx_v_tau[__pyx_t_1]) = ((__pyx_v_tau[__pyx_t_1]) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">159</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>: 	pa = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_pa = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>: 	if center == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((__pyx_v_center == 0) != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>: 		pa = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_pa = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>: 	pb = (pa+1) % 2</pre>
<pre class='cython code score-0 '>  __pyx_v_pb = ((__pyx_v_pa + 1) % 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">164</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>: 	sum = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_sum = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>: 	val = 1.0</pre>
<pre class='cython code score-0 '>  __pyx_v_val = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>: 	for mu in range(0, tau[0]):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_tau[0]);
  __pyx_t_4 = __pyx_t_1;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_mu = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>: 		for nu in range(0, tau[1]):</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = (__pyx_v_tau[1]);
    __pyx_t_7 = __pyx_t_6;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_nu = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>: 			for vu in range(0, tau[2]):</pre>
<pre class='cython code score-0 '>      __pyx_t_9 = (__pyx_v_tau[2]);
      __pyx_t_10 = __pyx_t_9;
      for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_vu = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>: 				val = 1.0</pre>
<pre class='cython code score-0 '>        __pyx_v_val = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>: 				xi = [mu,nu,vu]</pre>
<pre class='cython code score-0 '>        __pyx_t_12[0] = __pyx_v_mu;
        __pyx_t_12[1] = __pyx_v_nu;
        __pyx_t_12[2] = __pyx_v_vu;
        memcpy(&amp;(__pyx_v_xi[0]), __pyx_t_12, sizeof(__pyx_v_xi[0]) * (3));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>: 				for i in range(0, 3):</pre>
<pre class='cython code score-0 '>        for (__pyx_t_13 = 0; __pyx_t_13 &lt; 3; __pyx_t_13+=1) {
          __pyx_v_i = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>: 					if i == x:</pre>
<pre class='cython code score-0 '>          __pyx_t_3 = ((__pyx_v_i == __pyx_v_x) != 0);
          if (__pyx_t_3) {
/* … */
            goto __pyx_L14;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>: 						val *= efx(ia[x], ja[x], xi[x], ir[x]-jr[x], ie, je, n[x], ir[x]-nucleus[x], pa, pb)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_v_x;
            __pyx_t_15.__pyx_n = 4;
            __pyx_t_15.n = (__pyx_v_n[__pyx_v_x]);
            __pyx_t_15.x = ((__pyx_v_ir[__pyx_v_x]) - (*((double *) ( /* dim=0 */ (__pyx_v_nucleus.data + __pyx_t_2 * __pyx_v_nucleus.strides[0]) ))));
            __pyx_t_15.p = __pyx_v_pa;
            __pyx_t_15.s = __pyx_v_pb;
            __pyx_t_14 = __pyx_f_7ocypete_efx((__pyx_v_ia[__pyx_v_x]), (__pyx_v_ja[__pyx_v_x]), (__pyx_v_xi[__pyx_v_x]), ((__pyx_v_ir[__pyx_v_x]) - (__pyx_v_jr[__pyx_v_x])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_15); 
            __pyx_v_val = (__pyx_v_val * __pyx_t_14);
</pre><pre class="cython line score-0">&#xA0;<span class="">176</span>: 					else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>: 						val *=   cye(ia[i], ja[i], xi[i], ir[i]-jr[i], ie, je, n[i], ir[i]-nucleus[i])</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_2 = __pyx_v_i;
            __pyx_t_16.__pyx_n = 2;
            __pyx_t_16.n = (__pyx_v_n[__pyx_v_i]);
            __pyx_t_16.x = ((__pyx_v_ir[__pyx_v_i]) - (*((double *) ( /* dim=0 */ (__pyx_v_nucleus.data + __pyx_t_2 * __pyx_v_nucleus.strides[0]) ))));
            __pyx_t_14 = __pyx_f_7ocypete_cye((__pyx_v_ia[__pyx_v_i]), (__pyx_v_ja[__pyx_v_i]), (__pyx_v_xi[__pyx_v_i]), ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_jr[__pyx_v_i])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_16); 
            __pyx_v_val = (__pyx_v_val * __pyx_t_14);
          }
          __pyx_L14:;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">178</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>: 				sum += val * clmb(mu,nu,vu, 0, p, r[0], r[1], r[2] )</pre>
<pre class='cython code score-0 '>        __pyx_v_sum = (__pyx_v_sum + (__pyx_v_val * __pyx_f_7ocypete_clmb(__pyx_v_mu, __pyx_v_nu, __pyx_v_vu, 0, __pyx_v_p, (__pyx_v_r[0]), (__pyx_v_r[1]), (__pyx_v_r[2]))));
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">180</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>: 	return sum * 2 * pi/p</pre>
<pre class='cython code score-0 '>  __pyx_r = (((__pyx_v_sum * 2.0) * __pyx_v_7ocypete_pi) / __pyx_v_p);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">182</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>: cdef double clmbhfx(int[3] ia, int[3] ja, double ie, double je, double[3] ir, double[3] jr, \</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_clmbhfx(int *__pyx_v_ia, int *__pyx_v_ja, double __pyx_v_ie, double __pyx_v_je, double *__pyx_v_ir, double *__pyx_v_jr, __Pyx_memviewslice __pyx_v_nucleus, int *__pyx_v_n, CYTHON_UNUSED double *__pyx_v_origin, int __pyx_v_x) {
  double __pyx_v_p;
  double __pyx_v_q[3];
  double __pyx_v_r[3];
  int __pyx_v_i;
  int __pyx_v_mu;
  int __pyx_v_nu;
  int __pyx_v_vu;
  int __pyx_v_tau[3];
  double __pyx_v_sum;
  double __pyx_v_val;
  int __pyx_v_xi[3];
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clmbhfx", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">184</span>:                double[:] nucleus, int[3] n, double[3] origin, int x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>: 	#generalised coulomb derivatives dV(ab^(0,0,0))/dx terms</pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>: 	cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>: 		double p = ie + je</pre>
<pre class='cython code score-0 '>  __pyx_v_p = (__pyx_v_ie + __pyx_v_je);
</pre><pre class="cython line score-0">&#xA0;<span class="">189</span>: 		double[3] q, r</pre>
<pre class="cython line score-0">&#xA0;<span class="">190</span>: 		int i, mu, nu, vu, pa, pb</pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>: 		int[3] tau</pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: 		double sum, val</pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>: 		int[3] xi</pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>: 	for i in range(0, 3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>: 		q[i] = (ie*ir[i] + je*jr[i])/p</pre>
<pre class='cython code score-0 '>    (__pyx_v_q[__pyx_v_i]) = (((__pyx_v_ie * (__pyx_v_ir[__pyx_v_i])) + (__pyx_v_je * (__pyx_v_jr[__pyx_v_i]))) / __pyx_v_p);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>: 		tau[i] = ia[i] + ja[i] + n[i] + 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_tau[__pyx_v_i]) = ((((__pyx_v_ia[__pyx_v_i]) + (__pyx_v_ja[__pyx_v_i])) + (__pyx_v_n[__pyx_v_i])) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>: 		r[i] = q[i] - nucleus[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_i;
    (__pyx_v_r[__pyx_v_i]) = ((__pyx_v_q[__pyx_v_i]) - (*((double *) ( /* dim=0 */ (__pyx_v_nucleus.data + __pyx_t_2 * __pyx_v_nucleus.strides[0]) ))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">199</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>: 	sum = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_sum = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>: 	val = 1.0</pre>
<pre class='cython code score-0 '>  __pyx_v_val = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">202</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>: 	for mu in range(0, tau[0]):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_tau[0]);
  __pyx_t_3 = __pyx_t_1;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_mu = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>: 		for nu in range(0, tau[1]):</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = (__pyx_v_tau[1]);
    __pyx_t_6 = __pyx_t_5;
    for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_nu = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>: 			for vu in range(0, tau[2]):</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = (__pyx_v_tau[2]);
      __pyx_t_9 = __pyx_t_8;
      for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
        __pyx_v_vu = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>: 				val = 1.0</pre>
<pre class='cython code score-0 '>        __pyx_v_val = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>: 				xi = [mu,nu,vu]</pre>
<pre class='cython code score-0 '>        __pyx_t_11[0] = __pyx_v_mu;
        __pyx_t_11[1] = __pyx_v_nu;
        __pyx_t_11[2] = __pyx_v_vu;
        memcpy(&amp;(__pyx_v_xi[0]), __pyx_t_11, sizeof(__pyx_v_xi[0]) * (3));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>: 				for i in range(0, 3):</pre>
<pre class='cython code score-0 '>        for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
          __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>: 					val *=   cye(ia[i], ja[i], xi[i], ir[i]-jr[i], ie, je, n[i], ir[i]-nucleus[i])</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_v_i;
          __pyx_t_14.__pyx_n = 2;
          __pyx_t_14.n = (__pyx_v_n[__pyx_v_i]);
          __pyx_t_14.x = ((__pyx_v_ir[__pyx_v_i]) - (*((double *) ( /* dim=0 */ (__pyx_v_nucleus.data + __pyx_t_2 * __pyx_v_nucleus.strides[0]) ))));
          __pyx_t_13 = __pyx_f_7ocypete_cye((__pyx_v_ia[__pyx_v_i]), (__pyx_v_ja[__pyx_v_i]), (__pyx_v_xi[__pyx_v_i]), ((__pyx_v_ir[__pyx_v_i]) - (__pyx_v_jr[__pyx_v_i])), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_14); 
          __pyx_v_val = (__pyx_v_val * __pyx_t_13);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">210</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>: 				xi[x] += 1</pre>
<pre class='cython code score-0 '>        __pyx_t_12 = __pyx_v_x;
        (__pyx_v_xi[__pyx_t_12]) = ((__pyx_v_xi[__pyx_t_12]) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>: 				sum -= val * clmb(xi[0],xi[1],xi[2], 0, p, r[0], r[1], r[2] )</pre>
<pre class='cython code score-0 '>        __pyx_v_sum = (__pyx_v_sum - (__pyx_v_val * __pyx_f_7ocypete_clmb((__pyx_v_xi[0]), (__pyx_v_xi[1]), (__pyx_v_xi[2]), 0, __pyx_v_p, (__pyx_v_r[0]), (__pyx_v_r[1]), (__pyx_v_r[2]))));
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">214</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>: 	return sum * 2 * pi/p</pre>
<pre class='cython code score-0 '>  __pyx_r = (((__pyx_v_sum * 2.0) * __pyx_v_7ocypete_pi) / __pyx_v_p);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>: cdef double teifx(short[:] ia, short[:] ja, short[:] ka, short[:] la, double ie, double je, double ke, double le, \</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_teifx(__Pyx_memviewslice __pyx_v_ia, __Pyx_memviewslice __pyx_v_ja, __Pyx_memviewslice __pyx_v_ka, __Pyx_memviewslice __pyx_v_la, double __pyx_v_ie, double __pyx_v_je, double __pyx_v_ke, double __pyx_v_le, __Pyx_memviewslice __pyx_v_ir, __Pyx_memviewslice __pyx_v_jr, __Pyx_memviewslice __pyx_v_kr, __Pyx_memviewslice __pyx_v_lr, int *__pyx_v_ra, int *__pyx_v_rb, double *__pyx_v_origin, int __pyx_v_x, int __pyx_v_center) {
  double __pyx_v_p;
  double __pyx_v_q;
  double __pyx_v_rho;
  double __pyx_v_P[3];
  double __pyx_v_Q[3];
  double __pyx_v_r[3];
  int __pyx_v_i;
  int __pyx_v_pa;
  int __pyx_v_pb;
  int __pyx_v_mu;
  int __pyx_v_nu;
  int __pyx_v_vu;
  int __pyx_v_psi;
  int __pyx_v_phi;
  int __pyx_v_chi;
  int __pyx_v_xia[3];
  int __pyx_v_xib[3];
  int __pyx_v_tau[3];
  int __pyx_v_sigma[3];
  double __pyx_v_val;
  double __pyx_v_term;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("teifx", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">218</span>: 	              double[:] ir, double[:] jr, double[:] kr, double[:] lr, int[3] ra, int[3] rb, double[3] origin, int x, int center):</pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>: 	cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>: 		double p = ie + je</pre>
<pre class='cython code score-0 '>  __pyx_v_p = (__pyx_v_ie + __pyx_v_je);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>: 		double q = ke + le</pre>
<pre class='cython code score-0 '>  __pyx_v_q = (__pyx_v_ke + __pyx_v_le);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>: 		double rho = p*q/(p + q)</pre>
<pre class='cython code score-0 '>  __pyx_v_rho = ((__pyx_v_p * __pyx_v_q) / (__pyx_v_p + __pyx_v_q));
</pre><pre class="cython line score-0">&#xA0;<span class="">224</span>: 		double[3] P, Q, r</pre>
<pre class="cython line score-0">&#xA0;<span class="">225</span>: 		int i, pa, pb, mu, nu, vu, psi, phi, chi</pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>: 		int[3] xia, xib, tau, sigma</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>: 		double val = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_val = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">228</span>: 		double term</pre>
<pre class="cython line score-0">&#xA0;<span class="">229</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>: 	for i in range(0, 3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>: 		P[i] = (ie*ir[i] + je*jr[i])/p</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = __pyx_v_i;
    (__pyx_v_P[__pyx_v_i]) = (((__pyx_v_ie * (*((double *) ( /* dim=0 */ (__pyx_v_ir.data + __pyx_t_2 * __pyx_v_ir.strides[0]) )))) + (__pyx_v_je * (*((double *) ( /* dim=0 */ (__pyx_v_jr.data + __pyx_t_3 * __pyx_v_jr.strides[0]) ))))) / __pyx_v_p);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>: 		Q[i] = (ke*kr[i] + le*lr[i])/q</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = __pyx_v_i;
    (__pyx_v_Q[__pyx_v_i]) = (((__pyx_v_ke * (*((double *) ( /* dim=0 */ (__pyx_v_kr.data + __pyx_t_3 * __pyx_v_kr.strides[0]) )))) + (__pyx_v_le * (*((double *) ( /* dim=0 */ (__pyx_v_lr.data + __pyx_t_2 * __pyx_v_lr.strides[0]) ))))) / __pyx_v_q);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>: 		r[i] = P[i] - Q[i]</pre>
<pre class='cython code score-0 '>    (__pyx_v_r[__pyx_v_i]) = ((__pyx_v_P[__pyx_v_i]) - (__pyx_v_Q[__pyx_v_i]));
</pre><pre class="cython line score-0">&#xA0;<span class="">234</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>: 		tau[i] = ia[i] + ja[i] + 1 + ra[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = __pyx_v_i;
    (__pyx_v_tau[__pyx_v_i]) = ((((*((short *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_2 * __pyx_v_ia.strides[0]) ))) + (*((short *) ( /* dim=0 */ (__pyx_v_ja.data + __pyx_t_3 * __pyx_v_ja.strides[0]) )))) + 1) + (__pyx_v_ra[__pyx_v_i]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>: 		sigma[i] = ka[i] + la[i] + 1 + rb[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = __pyx_v_i;
    (__pyx_v_sigma[__pyx_v_i]) = ((((*((short *) ( /* dim=0 */ (__pyx_v_ka.data + __pyx_t_3 * __pyx_v_ka.strides[0]) ))) + (*((short *) ( /* dim=0 */ (__pyx_v_la.data + __pyx_t_2 * __pyx_v_la.strides[0]) )))) + 1) + (__pyx_v_rb[__pyx_v_i]));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>: 	if (center == 0) or (center == 1):</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_center) {
    case 0:
    case 1:
/* … */
    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>: 		tau[x] += 1</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_x;
    (__pyx_v_tau[__pyx_t_1]) = ((__pyx_v_tau[__pyx_t_1]) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">240</span>: 	else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>: 		sigma[x] += 1</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_x;
    (__pyx_v_sigma[__pyx_t_1]) = ((__pyx_v_sigma[__pyx_t_1]) + 1);
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">242</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>: 	pa = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_pa = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>: 	if (center == 0) or (center == 2):</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_center) {
    case 0:
    case 2:
/* … */
    break;
    default: break;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>: 		pa = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_pa = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>: 	pb = (pa+1) % 2</pre>
<pre class='cython code score-0 '>  __pyx_v_pb = ((__pyx_v_pa + 1) % 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">247</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>: 	for mu in range(tau[0]):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_tau[0]);
  __pyx_t_4 = __pyx_t_1;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_mu = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>: 		for nu in range(tau[1]):</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = (__pyx_v_tau[1]);
    __pyx_t_7 = __pyx_t_6;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_nu = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>: 			for vu in range(tau[2]):</pre>
<pre class='cython code score-0 '>      __pyx_t_9 = (__pyx_v_tau[2]);
      __pyx_t_10 = __pyx_t_9;
      for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_vu = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>: 				for psi in range(sigma[0]):</pre>
<pre class='cython code score-0 '>        __pyx_t_12 = (__pyx_v_sigma[0]);
        __pyx_t_13 = __pyx_t_12;
        for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
          __pyx_v_psi = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>: 					for phi in range(sigma[1]):</pre>
<pre class='cython code score-0 '>          __pyx_t_15 = (__pyx_v_sigma[1]);
          __pyx_t_16 = __pyx_t_15;
          for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
            __pyx_v_phi = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>: 						for chi in range(sigma[2]):</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_sigma[2]);
            __pyx_t_19 = __pyx_t_18;
            for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
              __pyx_v_chi = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>: 							xia = [mu, nu, vu]</pre>
<pre class='cython code score-0 '>              __pyx_t_21[0] = __pyx_v_mu;
              __pyx_t_21[1] = __pyx_v_nu;
              __pyx_t_21[2] = __pyx_v_vu;
              memcpy(&amp;(__pyx_v_xia[0]), __pyx_t_21, sizeof(__pyx_v_xia[0]) * (3));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>: 							xib = [psi, phi, chi]</pre>
<pre class='cython code score-0 '>              __pyx_t_22[0] = __pyx_v_psi;
              __pyx_t_22[1] = __pyx_v_phi;
              __pyx_t_22[2] = __pyx_v_chi;
              memcpy(&amp;(__pyx_v_xib[0]), __pyx_t_22, sizeof(__pyx_v_xib[0]) * (3));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>: 							term = 1.0</pre>
<pre class='cython code score-0 '>              __pyx_v_term = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>: 							for i in range(0, 3):</pre>
<pre class='cython code score-0 '>              for (__pyx_t_23 = 0; __pyx_t_23 &lt; 3; __pyx_t_23+=1) {
                __pyx_v_i = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">258</span>: 								if (i == x):</pre>
<pre class='cython code score-0 '>                __pyx_t_24 = ((__pyx_v_i == __pyx_v_x) != 0);
                if (__pyx_t_24) {
/* … */
                  goto __pyx_L19;
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>: 									if (center == 0 or center == 1):</pre>
<pre class='cython code score-0 '>                  switch (__pyx_v_center) {
                    case 0:
                    case 1:
/* … */
                    break;
                    case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>: 										term *= efx(ia[x],ja[x],xia[x],ir[x]-jr[x],ie,je,ra[x],ir[x] - origin[x], pa, pb)</pre>
<pre class='cython code score-0 '>                    __pyx_t_2 = __pyx_v_x;
                    __pyx_t_3 = __pyx_v_x;
                    __pyx_t_25 = __pyx_v_x;
                    __pyx_t_26 = __pyx_v_x;
                    __pyx_t_27 = __pyx_v_x;
                    __pyx_t_29.__pyx_n = 4;
                    __pyx_t_29.n = (__pyx_v_ra[__pyx_v_x]);
                    __pyx_t_29.x = ((*((double *) ( /* dim=0 */ (__pyx_v_ir.data + __pyx_t_27 * __pyx_v_ir.strides[0]) ))) - (__pyx_v_origin[__pyx_v_x]));
                    __pyx_t_29.p = __pyx_v_pa;
                    __pyx_t_29.s = __pyx_v_pb;
                    __pyx_t_28 = __pyx_f_7ocypete_efx((*((short *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_2 * __pyx_v_ia.strides[0]) ))), (*((short *) ( /* dim=0 */ (__pyx_v_ja.data + __pyx_t_3 * __pyx_v_ja.strides[0]) ))), (__pyx_v_xia[__pyx_v_x]), ((*((double *) ( /* dim=0 */ (__pyx_v_ir.data + __pyx_t_25 * __pyx_v_ir.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_jr.data + __pyx_t_26 * __pyx_v_jr.strides[0]) )))), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_29); 
                    __pyx_v_term = (__pyx_v_term * __pyx_t_28);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>: 										term *= cye(ka[x],la[x],xib[x],kr[x]-lr[x],ke,le,rb[x],kr[x] - origin[x])</pre>
<pre class='cython code score-0 '>                    __pyx_t_27 = __pyx_v_x;
                    __pyx_t_26 = __pyx_v_x;
                    __pyx_t_25 = __pyx_v_x;
                    __pyx_t_3 = __pyx_v_x;
                    __pyx_t_2 = __pyx_v_x;
                    __pyx_t_30.__pyx_n = 2;
                    __pyx_t_30.n = (__pyx_v_rb[__pyx_v_x]);
                    __pyx_t_30.x = ((*((double *) ( /* dim=0 */ (__pyx_v_kr.data + __pyx_t_2 * __pyx_v_kr.strides[0]) ))) - (__pyx_v_origin[__pyx_v_x]));
                    __pyx_t_28 = __pyx_f_7ocypete_cye((*((short *) ( /* dim=0 */ (__pyx_v_ka.data + __pyx_t_27 * __pyx_v_ka.strides[0]) ))), (*((short *) ( /* dim=0 */ (__pyx_v_la.data + __pyx_t_26 * __pyx_v_la.strides[0]) ))), (__pyx_v_xib[__pyx_v_x]), ((*((double *) ( /* dim=0 */ (__pyx_v_kr.data + __pyx_t_25 * __pyx_v_kr.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_lr.data + __pyx_t_3 * __pyx_v_lr.strides[0]) )))), __pyx_v_ke, __pyx_v_le, &amp;__pyx_t_30); 
                    __pyx_v_term = (__pyx_v_term * __pyx_t_28);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>: 									elif (center == 2 or center == 3):</pre>
<pre class='cython code score-0 '>                    case 3:
/* … */
                    break;
                    default: break;
                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>: 										term *= cye(ia[x],ja[x],xia[x],ir[x]-jr[x],ie,je,ra[x],ir[x] - origin[x])</pre>
<pre class='cython code score-0 '>                    __pyx_t_2 = __pyx_v_x;
                    __pyx_t_3 = __pyx_v_x;
                    __pyx_t_25 = __pyx_v_x;
                    __pyx_t_26 = __pyx_v_x;
                    __pyx_t_27 = __pyx_v_x;
                    __pyx_t_30.__pyx_n = 2;
                    __pyx_t_30.n = (__pyx_v_ra[__pyx_v_x]);
                    __pyx_t_30.x = ((*((double *) ( /* dim=0 */ (__pyx_v_ir.data + __pyx_t_27 * __pyx_v_ir.strides[0]) ))) - (__pyx_v_origin[__pyx_v_x]));
                    __pyx_t_28 = __pyx_f_7ocypete_cye((*((short *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_2 * __pyx_v_ia.strides[0]) ))), (*((short *) ( /* dim=0 */ (__pyx_v_ja.data + __pyx_t_3 * __pyx_v_ja.strides[0]) ))), (__pyx_v_xia[__pyx_v_x]), ((*((double *) ( /* dim=0 */ (__pyx_v_ir.data + __pyx_t_25 * __pyx_v_ir.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_jr.data + __pyx_t_26 * __pyx_v_jr.strides[0]) )))), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_30); 
                    __pyx_v_term = (__pyx_v_term * __pyx_t_28);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>: 										term *= efx(ka[x],la[x],xib[x],kr[x]-lr[x],ke,le,rb[x],kr[x] - origin[x], pa, pb)</pre>
<pre class='cython code score-0 '>                    __pyx_t_27 = __pyx_v_x;
                    __pyx_t_26 = __pyx_v_x;
                    __pyx_t_25 = __pyx_v_x;
                    __pyx_t_3 = __pyx_v_x;
                    __pyx_t_2 = __pyx_v_x;
                    __pyx_t_29.__pyx_n = 4;
                    __pyx_t_29.n = (__pyx_v_rb[__pyx_v_x]);
                    __pyx_t_29.x = ((*((double *) ( /* dim=0 */ (__pyx_v_kr.data + __pyx_t_2 * __pyx_v_kr.strides[0]) ))) - (__pyx_v_origin[__pyx_v_x]));
                    __pyx_t_29.p = __pyx_v_pa;
                    __pyx_t_29.s = __pyx_v_pb;
                    __pyx_t_28 = __pyx_f_7ocypete_efx((*((short *) ( /* dim=0 */ (__pyx_v_ka.data + __pyx_t_27 * __pyx_v_ka.strides[0]) ))), (*((short *) ( /* dim=0 */ (__pyx_v_la.data + __pyx_t_26 * __pyx_v_la.strides[0]) ))), (__pyx_v_xib[__pyx_v_x]), ((*((double *) ( /* dim=0 */ (__pyx_v_kr.data + __pyx_t_25 * __pyx_v_kr.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_lr.data + __pyx_t_3 * __pyx_v_lr.strides[0]) )))), __pyx_v_ke, __pyx_v_le, &amp;__pyx_t_29); 
                    __pyx_v_term = (__pyx_v_term * __pyx_t_28);
</pre><pre class="cython line score-0">&#xA0;<span class="">265</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">266</span>: 								else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>: 									term *= cye(ia[i],ja[i],xia[i],ir[i]-jr[i],ie,je,ra[i],ir[i] - origin[i])</pre>
<pre class='cython code score-0 '>                /*else*/ {
                  __pyx_t_2 = __pyx_v_i;
                  __pyx_t_3 = __pyx_v_i;
                  __pyx_t_25 = __pyx_v_i;
                  __pyx_t_26 = __pyx_v_i;
                  __pyx_t_27 = __pyx_v_i;
                  __pyx_t_30.__pyx_n = 2;
                  __pyx_t_30.n = (__pyx_v_ra[__pyx_v_i]);
                  __pyx_t_30.x = ((*((double *) ( /* dim=0 */ (__pyx_v_ir.data + __pyx_t_27 * __pyx_v_ir.strides[0]) ))) - (__pyx_v_origin[__pyx_v_i]));
                  __pyx_t_28 = __pyx_f_7ocypete_cye((*((short *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_2 * __pyx_v_ia.strides[0]) ))), (*((short *) ( /* dim=0 */ (__pyx_v_ja.data + __pyx_t_3 * __pyx_v_ja.strides[0]) ))), (__pyx_v_xia[__pyx_v_i]), ((*((double *) ( /* dim=0 */ (__pyx_v_ir.data + __pyx_t_25 * __pyx_v_ir.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_jr.data + __pyx_t_26 * __pyx_v_jr.strides[0]) )))), __pyx_v_ie, __pyx_v_je, &amp;__pyx_t_30); 
                  __pyx_v_term = (__pyx_v_term * __pyx_t_28);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>: 									term *= cye(ka[i],la[i],xib[i],kr[i]-lr[i],ke,le,rb[i],kr[i] - origin[i])</pre>
<pre class='cython code score-0 '>                  __pyx_t_27 = __pyx_v_i;
                  __pyx_t_26 = __pyx_v_i;
                  __pyx_t_25 = __pyx_v_i;
                  __pyx_t_3 = __pyx_v_i;
                  __pyx_t_2 = __pyx_v_i;
                  __pyx_t_30.__pyx_n = 2;
                  __pyx_t_30.n = (__pyx_v_rb[__pyx_v_i]);
                  __pyx_t_30.x = ((*((double *) ( /* dim=0 */ (__pyx_v_kr.data + __pyx_t_2 * __pyx_v_kr.strides[0]) ))) - (__pyx_v_origin[__pyx_v_i]));
                  __pyx_t_28 = __pyx_f_7ocypete_cye((*((short *) ( /* dim=0 */ (__pyx_v_ka.data + __pyx_t_27 * __pyx_v_ka.strides[0]) ))), (*((short *) ( /* dim=0 */ (__pyx_v_la.data + __pyx_t_26 * __pyx_v_la.strides[0]) ))), (__pyx_v_xib[__pyx_v_i]), ((*((double *) ( /* dim=0 */ (__pyx_v_kr.data + __pyx_t_25 * __pyx_v_kr.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_lr.data + __pyx_t_3 * __pyx_v_lr.strides[0]) )))), __pyx_v_ke, __pyx_v_le, &amp;__pyx_t_30); 
                  __pyx_v_term = (__pyx_v_term * __pyx_t_28);
                }
                __pyx_L19:;
              }
</pre><pre class="cython line score-0">&#xA0;<span class="">269</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>: 							term *= pow(-1, (psi+phi+chi)) * clmb(mu+psi,nu+phi,vu+chi,0, rho,r[0], r[1], r[2])</pre>
<pre class='cython code score-0 '>              __pyx_v_term = (__pyx_v_term * (pow(-1.0, ((__pyx_v_psi + __pyx_v_phi) + __pyx_v_chi)) * __pyx_f_7ocypete_clmb((__pyx_v_mu + __pyx_v_psi), (__pyx_v_nu + __pyx_v_phi), (__pyx_v_vu + __pyx_v_chi), 0, __pyx_v_rho, (__pyx_v_r[0]), (__pyx_v_r[1]), (__pyx_v_r[2]))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>: 							val += term</pre>
<pre class='cython code score-0 '>              __pyx_v_val = (__pyx_v_val + __pyx_v_term);
            }
          }
        }
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">272</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>: 	return val*2*pow(pi,2.5)/(p*q*sqrt(p+q))</pre>
<pre class='cython code score-0 '>  __pyx_r = (((__pyx_v_val * 2.0) * pow(__pyx_v_7ocypete_pi, 2.5)) / ((__pyx_v_p * __pyx_v_q) * sqrt((__pyx_v_p + __pyx_v_q))));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">274</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">275</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>: cdef double erifx(short[:] ng, int p, int q, int r, int s, double[:,:] im, double[:,:] ic, double[:,:] ie, short[:,:] ia, double[:,:] io, \</pre>
<pre class='cython code score-0 '>static double __pyx_f_7ocypete_erifx(__Pyx_memviewslice __pyx_v_ng, int __pyx_v_p, int __pyx_v_q, int __pyx_v_r, int __pyx_v_s, __Pyx_memviewslice __pyx_v_im, __Pyx_memviewslice __pyx_v_ic, __Pyx_memviewslice __pyx_v_ie, __Pyx_memviewslice __pyx_v_ia, __Pyx_memviewslice __pyx_v_io, int __pyx_v_x, int __pyx_v_center) {
  double __pyx_v_sum;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_l;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("erifx", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">277</span>: 	              int x, int center):</pre>
<pre class="cython line score-0">&#xA0;<span class="">278</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">279</span>: 	cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>: 		double sum = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_sum = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">281</span>: 		int i, j, k, l</pre>
<pre class="cython line score-0">&#xA0;<span class="">282</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>: 	for i in range(0, ng[p]):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_p;
  __pyx_t_2 = (*((short *) ( /* dim=0 */ (__pyx_v_ng.data + __pyx_t_1 * __pyx_v_ng.strides[0]) )));
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>: 		for j in range(0, ng[q]):</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_q;
    __pyx_t_5 = (*((short *) ( /* dim=0 */ (__pyx_v_ng.data + __pyx_t_1 * __pyx_v_ng.strides[0]) )));
    __pyx_t_6 = __pyx_t_5;
    for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_j = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>: 			for k in range(0, ng[r]):</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = __pyx_v_r;
      __pyx_t_8 = (*((short *) ( /* dim=0 */ (__pyx_v_ng.data + __pyx_t_1 * __pyx_v_ng.strides[0]) )));
      __pyx_t_9 = __pyx_t_8;
      for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
        __pyx_v_k = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>: 				for l in range(0, ng[s]):</pre>
<pre class='cython code score-0 '>        __pyx_t_1 = __pyx_v_s;
        __pyx_t_11 = (*((short *) ( /* dim=0 */ (__pyx_v_ng.data + __pyx_t_1 * __pyx_v_ng.strides[0]) )));
        __pyx_t_12 = __pyx_t_11;
        for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_l = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>: 					sum += im[p,i]*im[q,j]*im[r,k]*im[s,l] * ic[p,i]*ic[q,j]*ic[r,k]*ic[s,l] *   \</pre>
<pre class='cython code score-0 '>          __pyx_t_1 = __pyx_v_p;
          __pyx_t_14 = __pyx_v_i;
          __pyx_t_15 = __pyx_v_q;
          __pyx_t_16 = __pyx_v_j;
          __pyx_t_17 = __pyx_v_r;
          __pyx_t_18 = __pyx_v_k;
          __pyx_t_19 = __pyx_v_s;
          __pyx_t_20 = __pyx_v_l;
          __pyx_t_21 = __pyx_v_p;
          __pyx_t_22 = __pyx_v_i;
          __pyx_t_23 = __pyx_v_q;
          __pyx_t_24 = __pyx_v_j;
          __pyx_t_25 = __pyx_v_r;
          __pyx_t_26 = __pyx_v_k;
          __pyx_t_27 = __pyx_v_s;
          __pyx_t_28 = __pyx_v_l;
/* … */
          __pyx_v_sum = (__pyx_v_sum + (((((((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_1 * __pyx_v_im.strides[0]) ) + __pyx_t_14 * __pyx_v_im.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_15 * __pyx_v_im.strides[0]) ) + __pyx_t_16 * __pyx_v_im.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_17 * __pyx_v_im.strides[0]) ) + __pyx_t_18 * __pyx_v_im.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_19 * __pyx_v_im.strides[0]) ) + __pyx_t_20 * __pyx_v_im.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ic.data + __pyx_t_21 * __pyx_v_ic.strides[0]) ) + __pyx_t_22 * __pyx_v_ic.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ic.data + __pyx_t_23 * __pyx_v_ic.strides[0]) ) + __pyx_t_24 * __pyx_v_ic.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ic.data + __pyx_t_25 * __pyx_v_ic.strides[0]) ) + __pyx_t_26 * __pyx_v_ic.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ic.data + __pyx_t_27 * __pyx_v_ic.strides[0]) ) + __pyx_t_28 * __pyx_v_ic.strides[1]) )))) * __pyx_f_7ocypete_teifx(__pyx_t_29, __pyx_t_30, __pyx_t_31, __pyx_t_32, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ie.data + __pyx_t_33 * __pyx_v_ie.strides[0]) ) + __pyx_t_34 * __pyx_v_ie.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ie.data + __pyx_t_35 * __pyx_v_ie.strides[0]) ) + __pyx_t_36 * __pyx_v_ie.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ie.data + __pyx_t_37 * __pyx_v_ie.strides[0]) ) + __pyx_t_38 * __pyx_v_ie.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ie.data + __pyx_t_39 * __pyx_v_ie.strides[0]) ) + __pyx_t_40 * __pyx_v_ie.strides[1]) ))), __pyx_t_41, __pyx_t_42, __pyx_t_43, __pyx_t_44, __pyx_t_45, __pyx_t_46, __pyx_t_47, __pyx_v_x, __pyx_v_center)));
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_29, 1);
          __pyx_t_29.memview = NULL;
          __pyx_t_29.data = NULL;
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
          __pyx_t_30.memview = NULL;
          __pyx_t_30.data = NULL;
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_31, 1);
          __pyx_t_31.memview = NULL;
          __pyx_t_31.data = NULL;
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_32, 1);
          __pyx_t_32.memview = NULL;
          __pyx_t_32.data = NULL;
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_41, 1);
          __pyx_t_41.memview = NULL;
          __pyx_t_41.data = NULL;
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_42, 1);
          __pyx_t_42.memview = NULL;
          __pyx_t_42.data = NULL;
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_43, 1);
          __pyx_t_43.memview = NULL;
          __pyx_t_43.data = NULL;
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_44, 1);
          __pyx_t_44.memview = NULL;
          __pyx_t_44.data = NULL;
        }
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>: 					       teifx(ia[p], ia[q], ia[r], ia[s], ie[p,i], ie[q,j], ie[r,k], ie[s,l], \</pre>
<pre class='cython code score-0 '>          __pyx_t_29.data = __pyx_v_ia.data;
          __pyx_t_29.memview = __pyx_v_ia.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_29, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_p;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_ia.strides[0];
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_29.shape[0] = __pyx_v_ia.shape[1];
__pyx_t_29.strides[0] = __pyx_v_ia.strides[1];
    __pyx_t_29.suboffsets[0] = -1;

__pyx_t_30.data = __pyx_v_ia.data;
          __pyx_t_30.memview = __pyx_v_ia.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_30, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_q;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_ia.strides[0];
        __pyx_t_30.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_30.shape[0] = __pyx_v_ia.shape[1];
__pyx_t_30.strides[0] = __pyx_v_ia.strides[1];
    __pyx_t_30.suboffsets[0] = -1;

__pyx_t_31.data = __pyx_v_ia.data;
          __pyx_t_31.memview = __pyx_v_ia.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_31, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_r;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_ia.strides[0];
        __pyx_t_31.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_31.shape[0] = __pyx_v_ia.shape[1];
__pyx_t_31.strides[0] = __pyx_v_ia.strides[1];
    __pyx_t_31.suboffsets[0] = -1;

__pyx_t_32.data = __pyx_v_ia.data;
          __pyx_t_32.memview = __pyx_v_ia.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_32, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_s;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_ia.strides[0];
        __pyx_t_32.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_32.shape[0] = __pyx_v_ia.shape[1];
__pyx_t_32.strides[0] = __pyx_v_ia.strides[1];
    __pyx_t_32.suboffsets[0] = -1;

__pyx_t_33 = __pyx_v_p;
          __pyx_t_34 = __pyx_v_i;
          __pyx_t_35 = __pyx_v_q;
          __pyx_t_36 = __pyx_v_j;
          __pyx_t_37 = __pyx_v_r;
          __pyx_t_38 = __pyx_v_k;
          __pyx_t_39 = __pyx_v_s;
          __pyx_t_40 = __pyx_v_l;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>: 					             io[p], io[q], io[r], io[s], [0,0,0], [0,0,0], [0,0,0], x, center)</pre>
<pre class='cython code score-0 '>          __pyx_t_41.data = __pyx_v_io.data;
          __pyx_t_41.memview = __pyx_v_io.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_41, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_p;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_io.strides[0];
        __pyx_t_41.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_41.shape[0] = __pyx_v_io.shape[1];
__pyx_t_41.strides[0] = __pyx_v_io.strides[1];
    __pyx_t_41.suboffsets[0] = -1;

__pyx_t_42.data = __pyx_v_io.data;
          __pyx_t_42.memview = __pyx_v_io.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_42, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_q;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_io.strides[0];
        __pyx_t_42.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_42.shape[0] = __pyx_v_io.shape[1];
__pyx_t_42.strides[0] = __pyx_v_io.strides[1];
    __pyx_t_42.suboffsets[0] = -1;

__pyx_t_43.data = __pyx_v_io.data;
          __pyx_t_43.memview = __pyx_v_io.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_43, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_r;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_io.strides[0];
        __pyx_t_43.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_43.shape[0] = __pyx_v_io.shape[1];
__pyx_t_43.strides[0] = __pyx_v_io.strides[1];
    __pyx_t_43.suboffsets[0] = -1;

__pyx_t_44.data = __pyx_v_io.data;
          __pyx_t_44.memview = __pyx_v_io.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_44, 0);
          {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_s;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_io.strides[0];
        __pyx_t_44.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_44.shape[0] = __pyx_v_io.shape[1];
__pyx_t_44.strides[0] = __pyx_v_io.strides[1];
    __pyx_t_44.suboffsets[0] = -1;

__pyx_t_45[0] = 0;
          __pyx_t_45[1] = 0;
          __pyx_t_45[2] = 0;
          __pyx_t_46[0] = 0;
          __pyx_t_46[1] = 0;
          __pyx_t_46[2] = 0;
          __pyx_t_47[0] = 0.0;
          __pyx_t_47[1] = 0.0;
          __pyx_t_47[2] = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">290</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>: 	return sum</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_sum;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">292</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">293</span>: #-----------------------------------End Shared Routines -----------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">294</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">295</span>: </pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>: cpdef ocypete(object molAtom,object molBasis, double[:,:] density, double[:,:] fock):</pre>
<pre class='cython code score-68 '>static PyObject *__pyx_pw_7ocypete_1ocypete(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7ocypete_ocypete(PyObject *__pyx_v_molAtom, PyObject *__pyx_v_molBasis, __Pyx_memviewslice __pyx_v_density, __Pyx_memviewslice __pyx_v_fock, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_na;
  int __pyx_v_nb;
  int __pyx_v_ng;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_p;
  int __pyx_v_q;
  int __pyx_v_r;
  int __pyx_v_s;
  PyObject *__pyx_v_mx = NULL;
  PyObject *__pyx_v_mz = NULL;
  __Pyx_memviewslice __pyx_v_alo_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alo_z = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_me = NULL;
  PyObject *__pyx_v_mc = NULL;
  PyObject *__pyx_v_mn = NULL;
  PyObject *__pyx_v_ma = NULL;
  PyObject *__pyx_v_mo = NULL;
  PyObject *__pyx_v_ml = NULL;
  PyObject *__pyx_v_mp = NULL;
  __Pyx_memviewslice __pyx_v_alo_e = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alo_c = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alo_n = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alo_a = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alo_o = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alo = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ala = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_ss;
  double __pyx_v_sk;
  double __pyx_v_sj;
  double __pyx_v_sh;
  double __pyx_v_si;
  double __pyx_v_sf;
  double __pyx_v_f;
  double __pyx_v_ra;
  double __pyx_v_rb;
  double __pyx_v_force;
  int __pyx_v_cart;
  PyObject *__pyx_v_Sx = NULL;
  PyObject *__pyx_v_Ix = NULL;
  PyObject *__pyx_v_Hx = NULL;
  PyObject *__pyx_v_Fx = NULL;
  PyObject *__pyx_v_Wx = NULL;
  PyObject *__pyx_v_Ex = NULL;
  PyObject *__pyx_v_Vx = NULL;
  __Pyx_memviewslice __pyx_v_overlapfx = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_teifx = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_oeifx = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_fockfx = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_weightedEnergy = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_energy = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vires = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_atom;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ocypete", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_79, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("ocypete.ocypete", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mz);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo_z, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_me);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mn);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ma);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mo);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ml);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mp);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo_e, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo_c, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo_n, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo_a, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo_o, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alo, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ala, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Sx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Ix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Hx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Fx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Wx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Ex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Vx);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_overlapfx, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_teifx, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_oeifx, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_fockfx, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_weightedEnergy, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_energy, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vires, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7ocypete_1ocypete(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7ocypete_1ocypete(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_molAtom = 0;
  PyObject *__pyx_v_molBasis = 0;
  __Pyx_memviewslice __pyx_v_density = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_fock = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ocypete (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_molAtom,&amp;__pyx_n_s_molBasis,&amp;__pyx_n_s_density,&amp;__pyx_n_s_fock,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_molAtom)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_molBasis)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ocypete", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ocypete", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_fock)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ocypete", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ocypete") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_molAtom = values[0];
    __pyx_v_molBasis = values[1];
    __pyx_v_density = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_density.memview)) __PYX_ERR(0, 296, __pyx_L3_error)</span>
    __pyx_v_fock = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_fock.memview)) __PYX_ERR(0, 296, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ocypete", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("ocypete.ocypete", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7ocypete_ocypete(__pyx_self, __pyx_v_molAtom, __pyx_v_molBasis, __pyx_v_density, __pyx_v_fock);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7ocypete_ocypete(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_molAtom, PyObject *__pyx_v_molBasis, __Pyx_memviewslice __pyx_v_density, __Pyx_memviewslice __pyx_v_fock) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ocypete", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_7ocypete_ocypete(__pyx_v_molAtom, __pyx_v_molBasis, __pyx_v_density, __pyx_v_fock, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("ocypete.ocypete", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_density, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_fock, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">297</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">298</span>: 	cdef:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>: 		int na = len(molAtom)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_molAtom);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  __pyx_v_na = __pyx_t_1;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>: 		int nb = len(molBasis)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_molBasis);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  __pyx_v_nb = __pyx_t_1;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>: 		int	ng = len(molBasis[0].co)</pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_co);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ng = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">302</span>: 		int  i, j, k, l, m, n, p, q, r, s</pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>: #get largest primative length</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>: 	for i in range(nb):</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_nb;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>: 		j = len(molBasis[i].co)</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_co);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 306, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_j = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>: 		if j &gt; ng:</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = ((__pyx_v_j &gt; __pyx_v_ng) != 0);
    if (__pyx_t_7) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>: 			ng = j</pre>
<pre class='cython code score-0 '>      __pyx_v_ng = __pyx_v_j;
</pre><pre class="cython line score-0">&#xA0;<span class="">309</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>: 	#convert atom class properties to c views</pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>: 	mx = np.empty([na,3], dtype = np.double)</pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_na);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_mx = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>: 	mz = np.empty([na], dtype = np.short)</pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_na);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_short);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_10, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_mz = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">313</span>: 	cdef:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>: 		double[:,:] alo_x = mx</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_mx, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  __pyx_v_alo_x = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>: 		short[:]   alo_z = mz</pre>
<pre class='cython code score-2 '>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_short</span>(__pyx_v_mz, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 315, __pyx_L1_error)</span>
  __pyx_v_alo_z = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>: 	for p in range(0, na):</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_na;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_p = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>: 		for q in range(0, 3):</pre>
<pre class='cython code score-0 '>    for (__pyx_t_13 = 0; __pyx_t_13 &lt; 3; __pyx_t_13+=1) {
      __pyx_v_q = __pyx_t_13;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>: 			alo_x[p,q] = molAtom[p].center[q]</pre>
<pre class='cython code score-19 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molAtom, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_center);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, __pyx_v_q, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9); if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_15 = __pyx_v_p;
      __pyx_t_16 = __pyx_v_q;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_15 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_x.strides[1]) )) = __pyx_t_14;
    }
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>: 		alo_z[p] = molAtom[p].number</pre>
<pre class='cython code score-13 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molAtom, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_number);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_As_short</span>(__pyx_t_2); if (unlikely((__pyx_t_17 == (short)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_16 = __pyx_v_p;
    *((short *) ( /* dim=0 */ (__pyx_v_alo_z.data + __pyx_t_16 * __pyx_v_alo_z.strides[0]) )) = __pyx_t_17;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">321</span>: 	#convert basis class properties to c-variables</pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">322</span>: 	me = np.empty([nb,ng], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_ng);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_10);
  __pyx_t_2 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_me = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>: 	mc = np.empty([nb,ng], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_ng);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_10);
  __pyx_t_3 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_10, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_mc = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>: 	mn = np.empty([nb,ng], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_ng);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_10);
  __pyx_t_2 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_mn = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>: 	ma = np.empty([nb,3],  dtype = np.short)</pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_short);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_3, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_ma = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>: 	mo = np.empty([nb,3],  dtype = np.double)</pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_mo = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>: 	ml = np.empty([nb],    dtype = np.short)</pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_short);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ml = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>: 	mp = np.empty([nb],    dtype = np.short)</pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_short);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_mp = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">329</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>: 	cdef:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>: 		double[:,:] alo_e = me</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_me, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
  __pyx_v_alo_e = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>: 		double[:,:] alo_c = mc</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_mc, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
  __pyx_v_alo_c = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>: 		double[:,:] alo_n = mn</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_mn, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
  __pyx_v_alo_n = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>: 		short[:,:]  alo_a = ma</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_short</span>(__pyx_v_ma, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
  __pyx_v_alo_a = __pyx_t_18;
  __pyx_t_18.memview = NULL;
  __pyx_t_18.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>: 		double[:,:] alo_o = mo</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_mo, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
  __pyx_v_alo_o = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>: 		short[:]    alo   = ml</pre>
<pre class='cython code score-2 '>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_short</span>(__pyx_v_ml, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
  __pyx_v_alo = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">337</span>: 		short[:]    ala   = mp</pre>
<pre class='cython code score-2 '>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_short</span>(__pyx_v_mp, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
  __pyx_v_ala = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">338</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>: 	for p in range(0, nb):</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_nb;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_p = __pyx_t_6;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>: 		alo[p] = len(molBasis[p].co)</pre>
<pre class='cython code score-11 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_co);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 340, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_16 = __pyx_v_p;
    *((short *) ( /* dim=0 */ (__pyx_v_alo.data + __pyx_t_16 * __pyx_v_alo.strides[0]) )) = __pyx_t_1;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>: 		ala[p] = molBasis[p].atom</pre>
<pre class='cython code score-13 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_atom);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 341, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_As_short</span>(__pyx_t_10); if (unlikely((__pyx_t_17 == (short)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 341, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_16 = __pyx_v_p;
    *((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_16 * __pyx_v_ala.strides[0]) )) = __pyx_t_17;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">342</span>: 		for q in range(0, len(molBasis[p].co)):</pre>
<pre class='cython code score-11 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_co);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 342, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_19 = __pyx_t_1;
    for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_19; __pyx_t_13+=1) {
      __pyx_v_q = __pyx_t_13;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>: 			alo_e[p,q] = molBasis[p].ex[q]</pre>
<pre class='cython code score-19 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_ex);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_10, __pyx_v_q, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9); if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_16 = __pyx_v_p;
      __pyx_t_15 = __pyx_v_q;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_16 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_e.strides[1]) )) = __pyx_t_14;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>: 			alo_c[p,q] = molBasis[p].co[q]</pre>
<pre class='cython code score-19 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_co);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_10, __pyx_v_q, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9); if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_15 = __pyx_v_p;
      __pyx_t_16 = __pyx_v_q;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_c.data + __pyx_t_15 * __pyx_v_alo_c.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_c.strides[1]) )) = __pyx_t_14;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>: 			alo_n[p,q] = molBasis[p].normal[q]</pre>
<pre class='cython code score-19 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_normal);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_10, __pyx_v_q, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9); if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_16 = __pyx_v_p;
      __pyx_t_15 = __pyx_v_q;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_n.data + __pyx_t_16 * __pyx_v_alo_n.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_n.strides[1]) )) = __pyx_t_14;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>: 		for q in range(0, 3):</pre>
<pre class='cython code score-0 '>    for (__pyx_t_13 = 0; __pyx_t_13 &lt; 3; __pyx_t_13+=1) {
      __pyx_v_q = __pyx_t_13;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">347</span>: 			alo_a[p,q] = molBasis[p].momentum[q]</pre>
<pre class='cython code score-16 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 347, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_momentum);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 347, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_10, __pyx_v_q, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 347, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_As_short</span>(__pyx_t_9); if (unlikely((__pyx_t_17 == (short)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 347, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_15 = __pyx_v_p;
      __pyx_t_16 = __pyx_v_q;
      *((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_15 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_a.strides[1]) )) = __pyx_t_17;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">348</span>: 			alo_o[p,q] = molBasis[p].center[q]</pre>
<pre class='cython code score-19 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_molBasis, __pyx_v_p, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_center);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_10, __pyx_v_q, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9); if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_16 = __pyx_v_p;
      __pyx_t_15 = __pyx_v_q;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_16 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_o.strides[1]) )) = __pyx_t_14;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>: 	#matrix definitions</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>: 	cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>: 		double ss, sk, sj, sh, si, sf, f, ra, rb, force</pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>: 		int cart</pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>: 	Sx = np.zeros([nb,nb], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_8);
  __pyx_t_9 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_8, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Sx = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>: 	Ix = np.zeros([nb,nb,nb,nb], dtype = np.double)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_20 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 2, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 3, __pyx_t_9);
  __pyx_t_3 = 0;
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_20);
  __pyx_t_20 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_20, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_v_Ix = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>: 	Hx = np.zeros([nb,nb], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_9);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_20, __pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Hx = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>: 	Fx = np.zeros([nb,nb], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_20 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_9);
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_20);
  __pyx_t_20 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_20, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_v_Fx = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>: 	Wx = np.zeros([nb,nb], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_9);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_20, __pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Wx = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>: 	Ex = np.zeros([nb,nb], dtype = np.double)</pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_20 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_9);
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_20);
  __pyx_t_20 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_20, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_v_Ex = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">360</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>: 	Vx = np.zeros([na,3], dtype = np.double)</pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_na);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_int_3);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_20, __pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_Vx = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">362</span>: 	cdef:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>: 		double[:,:]  overlapfx = Sx</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Sx, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  __pyx_v_overlapfx = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>: 		double[:,:,:,:]  teifx = Ix</pre>
<pre class='cython code score-2 '>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double</span>(__pyx_v_Ix, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
  __pyx_v_teifx = __pyx_t_21;
  __pyx_t_21.memview = NULL;
  __pyx_t_21.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>: 		double[:,:]      oeifx = Hx</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Hx, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
  __pyx_v_oeifx = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>: 		double[:,:]      fockfx= Fx</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Fx, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  __pyx_v_fockfx = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>: 		double[:,:]      weightedEnergy = Wx</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Wx, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  __pyx_v_weightedEnergy = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>: 		double[:,:]      energy = Ex</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Ex, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
  __pyx_v_energy = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">369</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>: 		double[:,:]      vires = Vx</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Vx, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  __pyx_v_vires = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">371</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">372</span>: 	#----------------------------------------Begin derivatives ------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">373</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">374</span>: 	#---------------------------------------Begin one electron-------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>: 	#don't need overlapfx for fock but included anyway for completeness</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>: 	for atom in range(0, na):</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_na;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_22 = 0; __pyx_t_22 &lt; __pyx_t_5; __pyx_t_22+=1) {
    __pyx_v_atom = __pyx_t_22;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>: 		for cart in range(0, 3):</pre>
<pre class='cython code score-0 '>    for (__pyx_t_6 = 0; __pyx_t_6 &lt; 3; __pyx_t_6+=1) {
      __pyx_v_cart = __pyx_t_6;
</pre><pre class="cython line score-0">&#xA0;<span class="">378</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">379</span>: 			for p in range(0, nb):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_nb;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_p = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>: 				for q in range(0, p+1):</pre>
<pre class='cython code score-0 '>        __pyx_t_25 = (__pyx_v_p + 1);
        __pyx_t_26 = __pyx_t_25;
        for (__pyx_t_27 = 0; __pyx_t_27 &lt; __pyx_t_26; __pyx_t_27+=1) {
          __pyx_v_q = __pyx_t_27;
</pre><pre class="cython line score-0">&#xA0;<span class="">381</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>: 					ss = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_v_ss = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>: 					sk = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_v_sk = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">384</span>: 					sj = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_v_sj = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">385</span>: 					sh = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_v_sh = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>: 					for i in range(0, alo[p]):</pre>
<pre class='cython code score-0 '>          __pyx_t_15 = __pyx_v_p;
          __pyx_t_17 = (*((short *) ( /* dim=0 */ (__pyx_v_alo.data + __pyx_t_15 * __pyx_v_alo.strides[0]) )));
          __pyx_t_28 = __pyx_t_17;
          for (__pyx_t_29 = 0; __pyx_t_29 &lt; __pyx_t_28; __pyx_t_29+=1) {
            __pyx_v_i = __pyx_t_29;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>: 						for j in range(0, alo[q]):</pre>
<pre class='cython code score-0 '>            __pyx_t_15 = __pyx_v_q;
            __pyx_t_30 = (*((short *) ( /* dim=0 */ (__pyx_v_alo.data + __pyx_t_15 * __pyx_v_alo.strides[0]) )));
            __pyx_t_31 = __pyx_t_30;
            for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_31; __pyx_t_32+=1) {
              __pyx_v_j = __pyx_t_32;
</pre><pre class="cython line score-0">&#xA0;<span class="">388</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">389</span>: 							f = alo_n[p,i] * alo_n[q,j] * alo_c[p,i] * alo_c[q,j]</pre>
<pre class='cython code score-0 '>              __pyx_t_15 = __pyx_v_p;
              __pyx_t_16 = __pyx_v_i;
              __pyx_t_33 = __pyx_v_q;
              __pyx_t_34 = __pyx_v_j;
              __pyx_t_35 = __pyx_v_p;
              __pyx_t_36 = __pyx_v_i;
              __pyx_t_37 = __pyx_v_q;
              __pyx_t_38 = __pyx_v_j;
              __pyx_v_f = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_n.data + __pyx_t_15 * __pyx_v_alo_n.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_n.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_n.data + __pyx_t_33 * __pyx_v_alo_n.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_n.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_c.data + __pyx_t_35 * __pyx_v_alo_c.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_c.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_c.data + __pyx_t_37 * __pyx_v_alo_c.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_c.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>: 							if ala[p] == atom:</pre>
<pre class='cython code score-0 '>              __pyx_t_38 = __pyx_v_p;
              __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_38 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
              if (__pyx_t_7) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>: 								ss += ovlpfx(alo_a[p,0], alo_a[p,1], alo_a[p,2], alo_a[q,0], alo_a[q,1], alo_a[q,2],  \</pre>
<pre class='cython code score-0 '>                __pyx_t_38 = __pyx_v_p;
                __pyx_t_37 = 0;
                __pyx_t_36 = __pyx_v_p;
                __pyx_t_35 = 1;
                __pyx_t_34 = __pyx_v_p;
                __pyx_t_33 = 2;
                __pyx_t_16 = __pyx_v_q;
                __pyx_t_15 = 0;
                __pyx_t_39 = __pyx_v_q;
                __pyx_t_40 = 1;
                __pyx_t_41 = __pyx_v_q;
                __pyx_t_42 = 2;
/* … */
                __pyx_v_ss = (__pyx_v_ss + (__pyx_f_7ocypete_ovlpfx((*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_38 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_36 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_34 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_16 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_39 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_40 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_41 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_42 * __pyx_v_alo_a.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_43 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_44 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_45 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_46 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_47 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_48 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_49 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_50 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_51 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_52 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_53 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_54 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_55 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_56 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_57 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_58 * __pyx_v_alo_o.strides[1]) ))), __pyx_t_59, __pyx_t_60, __pyx_v_cart, 0) * __pyx_v_f));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:  						                    alo_e[p,i], alo_e[q,j], alo_o[p,0], alo_o[p,1], alo_o[p,2], alo_o[q,0], alo_o[q,1], alo_o[q,2], \</pre>
<pre class='cython code score-0 '>                __pyx_t_43 = __pyx_v_p;
                __pyx_t_44 = __pyx_v_i;
                __pyx_t_45 = __pyx_v_q;
                __pyx_t_46 = __pyx_v_j;
                __pyx_t_47 = __pyx_v_p;
                __pyx_t_48 = 0;
                __pyx_t_49 = __pyx_v_p;
                __pyx_t_50 = 1;
                __pyx_t_51 = __pyx_v_p;
                __pyx_t_52 = 2;
                __pyx_t_53 = __pyx_v_q;
                __pyx_t_54 = 0;
                __pyx_t_55 = __pyx_v_q;
                __pyx_t_56 = 1;
                __pyx_t_57 = __pyx_v_q;
                __pyx_t_58 = 2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:  						                   [0,0,0], [0,0,0], cart, 0   ) * f</pre>
<pre class='cython code score-0 '>                __pyx_t_59[0] = 0;
                __pyx_t_59[1] = 0;
                __pyx_t_59[2] = 0;
                __pyx_t_60[0] = 0.0;
                __pyx_t_60[1] = 0.0;
                __pyx_t_60[2] = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">394</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>: 								sk += kntcfx([alo_a[p,0], alo_a[p,1], alo_a[p,2]], [alo_a[q,0], alo_a[q,1], alo_a[q,2]],  \</pre>
<pre class='cython code score-0 '>                __pyx_t_58 = __pyx_v_p;
                __pyx_t_57 = 0;
                __pyx_t_56 = __pyx_v_p;
                __pyx_t_55 = 1;
                __pyx_t_54 = __pyx_v_p;
                __pyx_t_53 = 2;
                __pyx_t_61[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_58 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_57 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_61[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_56 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_55 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_61[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_54 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_53 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_53 = __pyx_v_q;
                __pyx_t_54 = 0;
                __pyx_t_55 = __pyx_v_q;
                __pyx_t_56 = 1;
                __pyx_t_57 = __pyx_v_q;
                __pyx_t_58 = 2;
                __pyx_t_62[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_53 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_54 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_62[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_55 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_56 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_62[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_57 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_58 * __pyx_v_alo_a.strides[1]) )));
/* … */
                __pyx_v_sk = (__pyx_v_sk + (__pyx_f_7ocypete_kntcfx(__pyx_t_61, __pyx_t_62, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_58 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_57 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_56 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_55 * __pyx_v_alo_e.strides[1]) ))), __pyx_t_63, __pyx_t_64, __pyx_t_65, __pyx_t_66, __pyx_v_cart, 0) * __pyx_v_f));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:  						                    alo_e[p,i], alo_e[q,j], [alo_o[p,0], alo_o[p,1], alo_o[p,2]], [alo_o[q,0], alo_o[q,1], alo_o[q,2]], \</pre>
<pre class='cython code score-0 '>                __pyx_t_58 = __pyx_v_p;
                __pyx_t_57 = __pyx_v_i;
                __pyx_t_56 = __pyx_v_q;
                __pyx_t_55 = __pyx_v_j;
                __pyx_t_54 = __pyx_v_p;
                __pyx_t_53 = 0;
                __pyx_t_52 = __pyx_v_p;
                __pyx_t_51 = 1;
                __pyx_t_50 = __pyx_v_p;
                __pyx_t_49 = 2;
                __pyx_t_63[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_54 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_53 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_63[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_52 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_51 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_63[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_50 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_49 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_49 = __pyx_v_q;
                __pyx_t_50 = 0;
                __pyx_t_51 = __pyx_v_q;
                __pyx_t_52 = 1;
                __pyx_t_53 = __pyx_v_q;
                __pyx_t_54 = 2;
                __pyx_t_64[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_49 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_50 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_64[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_51 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_52 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_64[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_53 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_54 * __pyx_v_alo_o.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:  						                   [0,0,0], [0,0,0], cart, 0   ) * f</pre>
<pre class='cython code score-0 '>                __pyx_t_65[0] = 0;
                __pyx_t_65[1] = 0;
                __pyx_t_65[2] = 0;
                __pyx_t_66[0] = 0.0;
                __pyx_t_66[1] = 0.0;
                __pyx_t_66[2] = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">398</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>: 							if ala[q] == atom:</pre>
<pre class='cython code score-0 '>              __pyx_t_55 = __pyx_v_q;
              __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_55 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
              if (__pyx_t_7) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>: 								ss += ovlpfx(alo_a[p,0], alo_a[p,1], alo_a[p,2], alo_a[q,0], alo_a[q,1], alo_a[q,2],  \</pre>
<pre class='cython code score-0 '>                __pyx_t_55 = __pyx_v_p;
                __pyx_t_56 = 0;
                __pyx_t_57 = __pyx_v_p;
                __pyx_t_58 = 1;
                __pyx_t_54 = __pyx_v_p;
                __pyx_t_53 = 2;
                __pyx_t_52 = __pyx_v_q;
                __pyx_t_51 = 0;
                __pyx_t_50 = __pyx_v_q;
                __pyx_t_49 = 1;
                __pyx_t_48 = __pyx_v_q;
                __pyx_t_47 = 2;
/* … */
                __pyx_v_ss = (__pyx_v_ss + (__pyx_f_7ocypete_ovlpfx((*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_55 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_56 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_57 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_58 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_54 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_53 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_52 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_51 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_50 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_49 * __pyx_v_alo_a.strides[1]) ))), (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_48 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_47 * __pyx_v_alo_a.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_46 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_45 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_44 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_43 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_42 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_41 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_40 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_39 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_15 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_33 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_35 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_o.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_37 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_o.strides[1]) ))), __pyx_t_67, __pyx_t_68, __pyx_v_cart, 1) * __pyx_v_f));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:  						                    alo_e[p,i], alo_e[q,j], alo_o[p,0], alo_o[p,1], alo_o[p,2], alo_o[q,0], alo_o[q,1], alo_o[q,2], \</pre>
<pre class='cython code score-0 '>                __pyx_t_46 = __pyx_v_p;
                __pyx_t_45 = __pyx_v_i;
                __pyx_t_44 = __pyx_v_q;
                __pyx_t_43 = __pyx_v_j;
                __pyx_t_42 = __pyx_v_p;
                __pyx_t_41 = 0;
                __pyx_t_40 = __pyx_v_p;
                __pyx_t_39 = 1;
                __pyx_t_15 = __pyx_v_p;
                __pyx_t_16 = 2;
                __pyx_t_33 = __pyx_v_q;
                __pyx_t_34 = 0;
                __pyx_t_35 = __pyx_v_q;
                __pyx_t_36 = 1;
                __pyx_t_37 = __pyx_v_q;
                __pyx_t_38 = 2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:  						                    [0,0,0], [0,0,0], cart, 1  ) * f</pre>
<pre class='cython code score-0 '>                __pyx_t_67[0] = 0;
                __pyx_t_67[1] = 0;
                __pyx_t_67[2] = 0;
                __pyx_t_68[0] = 0.0;
                __pyx_t_68[1] = 0.0;
                __pyx_t_68[2] = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">403</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>: 								sk += kntcfx([alo_a[p,0], alo_a[p,1], alo_a[p,2]], [alo_a[q,0], alo_a[q,1], alo_a[q,2]],  \</pre>
<pre class='cython code score-0 '>                __pyx_t_38 = __pyx_v_p;
                __pyx_t_37 = 0;
                __pyx_t_36 = __pyx_v_p;
                __pyx_t_35 = 1;
                __pyx_t_34 = __pyx_v_p;
                __pyx_t_33 = 2;
                __pyx_t_69[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_38 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_69[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_36 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_69[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_34 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_33 = __pyx_v_q;
                __pyx_t_34 = 0;
                __pyx_t_35 = __pyx_v_q;
                __pyx_t_36 = 1;
                __pyx_t_37 = __pyx_v_q;
                __pyx_t_38 = 2;
                __pyx_t_70[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_33 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_70[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_35 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_a.strides[1]) )));
                __pyx_t_70[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_37 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_a.strides[1]) )));
/* … */
                __pyx_v_sk = (__pyx_v_sk + (__pyx_f_7ocypete_kntcfx(__pyx_t_69, __pyx_t_70, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_38 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_36 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_e.strides[1]) ))), __pyx_t_71, __pyx_t_72, __pyx_t_73, __pyx_t_74, __pyx_v_cart, 1) * __pyx_v_f));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:  						                    alo_e[p,i], alo_e[q,j], [alo_o[p,0], alo_o[p,1], alo_o[p,2]], [alo_o[q,0], alo_o[q,1], alo_o[q,2]], \</pre>
<pre class='cython code score-0 '>                __pyx_t_38 = __pyx_v_p;
                __pyx_t_37 = __pyx_v_i;
                __pyx_t_36 = __pyx_v_q;
                __pyx_t_35 = __pyx_v_j;
                __pyx_t_34 = __pyx_v_p;
                __pyx_t_33 = 0;
                __pyx_t_16 = __pyx_v_p;
                __pyx_t_15 = 1;
                __pyx_t_39 = __pyx_v_p;
                __pyx_t_40 = 2;
                __pyx_t_71[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_34 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_71[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_16 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_71[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_39 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_40 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_40 = __pyx_v_q;
                __pyx_t_39 = 0;
                __pyx_t_15 = __pyx_v_q;
                __pyx_t_16 = 1;
                __pyx_t_33 = __pyx_v_q;
                __pyx_t_34 = 2;
                __pyx_t_72[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_40 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_39 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_72[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_15 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_o.strides[1]) )));
                __pyx_t_72[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_33 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_o.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:  						                    [0,0,0], [0,0,0], cart, 1  ) * f</pre>
<pre class='cython code score-0 '>                __pyx_t_73[0] = 0;
                __pyx_t_73[1] = 0;
                __pyx_t_73[2] = 0;
                __pyx_t_74[0] = 0.0;
                __pyx_t_74[1] = 0.0;
                __pyx_t_74[2] = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">407</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">408</span>: 							sh -= clmbhfx([alo_a[p,0], alo_a[p,1], alo_a[p,2]], [alo_a[q,0], alo_a[q,1], alo_a[q,2]],  \</pre>
<pre class='cython code score-0 '>              __pyx_t_35 = __pyx_v_p;
              __pyx_t_36 = 0;
              __pyx_t_37 = __pyx_v_p;
              __pyx_t_38 = 1;
              __pyx_t_34 = __pyx_v_p;
              __pyx_t_33 = 2;
              __pyx_t_75[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_35 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_a.strides[1]) )));
              __pyx_t_75[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_37 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_a.strides[1]) )));
              __pyx_t_75[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_34 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_a.strides[1]) )));
              __pyx_t_33 = __pyx_v_q;
              __pyx_t_34 = 0;
              __pyx_t_38 = __pyx_v_q;
              __pyx_t_37 = 1;
              __pyx_t_36 = __pyx_v_q;
              __pyx_t_35 = 2;
              __pyx_t_76[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_33 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_a.strides[1]) )));
              __pyx_t_76[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_38 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_a.strides[1]) )));
              __pyx_t_76[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_36 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_a.strides[1]) )));
/* … */
              __pyx_v_sh = (__pyx_v_sh - ((__pyx_f_7ocypete_clmbhfx(__pyx_t_75, __pyx_t_76, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_35 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_37 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_e.strides[1]) ))), __pyx_t_77, __pyx_t_78, __pyx_t_79, __pyx_t_80, __pyx_t_81, __pyx_v_cart) * __pyx_v_f) * (*((short *) ( /* dim=0 */ (__pyx_v_alo_z.data + __pyx_t_34 * __pyx_v_alo_z.strides[0]) )))));
              __PYX_XDEC_MEMVIEW(&amp;__pyx_t_79, 1);
              __pyx_t_79.memview = NULL;
              __pyx_t_79.data = NULL;
            }
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">409</span>:  						                   alo_e[p,i], alo_e[q,j], [alo_o[p,0], alo_o[p,1], alo_o[p,2]], [alo_o[q,0], alo_o[q,1], alo_o[q,2]], \</pre>
<pre class='cython code score-0 '>              __pyx_t_35 = __pyx_v_p;
              __pyx_t_36 = __pyx_v_i;
              __pyx_t_37 = __pyx_v_q;
              __pyx_t_38 = __pyx_v_j;
              __pyx_t_34 = __pyx_v_p;
              __pyx_t_33 = 0;
              __pyx_t_16 = __pyx_v_p;
              __pyx_t_15 = 1;
              __pyx_t_39 = __pyx_v_p;
              __pyx_t_40 = 2;
              __pyx_t_77[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_34 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_o.strides[1]) )));
              __pyx_t_77[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_16 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_o.strides[1]) )));
              __pyx_t_77[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_39 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_40 * __pyx_v_alo_o.strides[1]) )));
              __pyx_t_40 = __pyx_v_q;
              __pyx_t_39 = 0;
              __pyx_t_15 = __pyx_v_q;
              __pyx_t_16 = 1;
              __pyx_t_33 = __pyx_v_q;
              __pyx_t_34 = 2;
              __pyx_t_78[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_40 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_39 * __pyx_v_alo_o.strides[1]) )));
              __pyx_t_78[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_15 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_o.strides[1]) )));
              __pyx_t_78[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_33 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_o.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>:  						                   alo_x[atom], [0,0,0], [0,0,0], cart  ) * f * alo_z[atom]</pre>
<pre class='cython code score-0 '>              __pyx_t_79.data = __pyx_v_alo_x.data;
              __pyx_t_79.memview = __pyx_v_alo_x.memview;
              __PYX_INC_MEMVIEW(&amp;__pyx_t_79, 0);
              {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_atom;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_alo_x.strides[0];
        __pyx_t_79.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_79.shape[0] = __pyx_v_alo_x.shape[1];
__pyx_t_79.strides[0] = __pyx_v_alo_x.strides[1];
    __pyx_t_79.suboffsets[0] = -1;

__pyx_t_80[0] = 0;
              __pyx_t_80[1] = 0;
              __pyx_t_80[2] = 0;
              __pyx_t_81[0] = 0.0;
              __pyx_t_81[1] = 0.0;
              __pyx_t_81[2] = 0.0;
/* … */
              __pyx_t_34 = __pyx_v_atom;
</pre><pre class="cython line score-0">&#xA0;<span class="">411</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">412</span>: 					for r in range(0, na):</pre>
<pre class='cython code score-0 '>          __pyx_t_29 = __pyx_v_na;
          __pyx_t_32 = __pyx_t_29;
          for (__pyx_t_82 = 0; __pyx_t_82 &lt; __pyx_t_32; __pyx_t_82+=1) {
            __pyx_v_r = __pyx_t_82;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>: 						for i in range(0, alo[p]):</pre>
<pre class='cython code score-0 '>            __pyx_t_34 = __pyx_v_p;
            __pyx_t_17 = (*((short *) ( /* dim=0 */ (__pyx_v_alo.data + __pyx_t_34 * __pyx_v_alo.strides[0]) )));
            __pyx_t_28 = __pyx_t_17;
            for (__pyx_t_83 = 0; __pyx_t_83 &lt; __pyx_t_28; __pyx_t_83+=1) {
              __pyx_v_i = __pyx_t_83;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">414</span>: 							for j in range(0, alo[q]):</pre>
<pre class='cython code score-0 '>              __pyx_t_34 = __pyx_v_q;
              __pyx_t_30 = (*((short *) ( /* dim=0 */ (__pyx_v_alo.data + __pyx_t_34 * __pyx_v_alo.strides[0]) )));
              __pyx_t_31 = __pyx_t_30;
              for (__pyx_t_84 = 0; __pyx_t_84 &lt; __pyx_t_31; __pyx_t_84+=1) {
                __pyx_v_j = __pyx_t_84;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">415</span>: 								f = alo_n[p,i] * alo_n[q,j] * alo_c[p,i] * alo_c[q,j]</pre>
<pre class='cython code score-0 '>                __pyx_t_34 = __pyx_v_p;
                __pyx_t_38 = __pyx_v_i;
                __pyx_t_37 = __pyx_v_q;
                __pyx_t_36 = __pyx_v_j;
                __pyx_t_35 = __pyx_v_p;
                __pyx_t_33 = __pyx_v_i;
                __pyx_t_16 = __pyx_v_q;
                __pyx_t_15 = __pyx_v_j;
                __pyx_v_f = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_n.data + __pyx_t_34 * __pyx_v_alo_n.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_n.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_n.data + __pyx_t_37 * __pyx_v_alo_n.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_n.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_c.data + __pyx_t_35 * __pyx_v_alo_c.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_c.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_c.data + __pyx_t_16 * __pyx_v_alo_c.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_c.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">416</span>: 								if ala[p] == atom:</pre>
<pre class='cython code score-0 '>                __pyx_t_15 = __pyx_v_p;
                __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_15 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
                if (__pyx_t_7) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">417</span>: 									sj -= clmbsfx([alo_a[p,0], alo_a[p,1], alo_a[p,2]], [alo_a[q,0], alo_a[q,1], alo_a[q,2]],  \</pre>
<pre class='cython code score-0 '>                  __pyx_t_15 = __pyx_v_p;
                  __pyx_t_16 = 0;
                  __pyx_t_33 = __pyx_v_p;
                  __pyx_t_35 = 1;
                  __pyx_t_36 = __pyx_v_p;
                  __pyx_t_37 = 2;
                  __pyx_t_85[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_15 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_85[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_33 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_85[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_36 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_37 = __pyx_v_q;
                  __pyx_t_36 = 0;
                  __pyx_t_35 = __pyx_v_q;
                  __pyx_t_33 = 1;
                  __pyx_t_16 = __pyx_v_q;
                  __pyx_t_15 = 2;
                  __pyx_t_86[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_37 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_86[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_35 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_86[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_16 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_a.strides[1]) )));
/* … */
                  __pyx_v_sj = (__pyx_v_sj - ((__pyx_f_7ocypete_clmbsfx(__pyx_t_85, __pyx_t_86, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_15 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_33 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_e.strides[1]) ))), __pyx_t_87, __pyx_t_88, __pyx_t_79, __pyx_t_89, __pyx_t_90, __pyx_v_cart, 0) * __pyx_v_f) * (*((short *) ( /* dim=0 */ (__pyx_v_alo_z.data + __pyx_t_36 * __pyx_v_alo_z.strides[0]) )))));
                  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_79, 1);
                  __pyx_t_79.memview = NULL;
                  __pyx_t_79.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">418</span>:  						                    alo_e[p,i], alo_e[q,j], [alo_o[p,0], alo_o[p,1], alo_o[p,2]], [alo_o[q,0], alo_o[q,1], alo_o[q,2]], \</pre>
<pre class='cython code score-0 '>                  __pyx_t_15 = __pyx_v_p;
                  __pyx_t_16 = __pyx_v_i;
                  __pyx_t_33 = __pyx_v_q;
                  __pyx_t_35 = __pyx_v_j;
                  __pyx_t_36 = __pyx_v_p;
                  __pyx_t_37 = 0;
                  __pyx_t_38 = __pyx_v_p;
                  __pyx_t_34 = 1;
                  __pyx_t_39 = __pyx_v_p;
                  __pyx_t_40 = 2;
                  __pyx_t_87[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_36 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_87[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_38 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_87[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_39 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_40 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_40 = __pyx_v_q;
                  __pyx_t_39 = 0;
                  __pyx_t_34 = __pyx_v_q;
                  __pyx_t_38 = 1;
                  __pyx_t_37 = __pyx_v_q;
                  __pyx_t_36 = 2;
                  __pyx_t_88[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_40 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_39 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_88[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_34 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_88[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_37 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_o.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">419</span>:  						                    alo_x[r], [0,0,0], [0,0,0], cart, 0  ) * f * alo_z[r]</pre>
<pre class='cython code score-0 '>                  __pyx_t_79.data = __pyx_v_alo_x.data;
                  __pyx_t_79.memview = __pyx_v_alo_x.memview;
                  __PYX_INC_MEMVIEW(&amp;__pyx_t_79, 0);
                  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_r;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_alo_x.strides[0];
        __pyx_t_79.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_79.shape[0] = __pyx_v_alo_x.shape[1];
__pyx_t_79.strides[0] = __pyx_v_alo_x.strides[1];
    __pyx_t_79.suboffsets[0] = -1;

__pyx_t_89[0] = 0;
                  __pyx_t_89[1] = 0;
                  __pyx_t_89[2] = 0;
                  __pyx_t_90[0] = 0.0;
                  __pyx_t_90[1] = 0.0;
                  __pyx_t_90[2] = 0.0;
/* … */
                  __pyx_t_36 = __pyx_v_r;
</pre><pre class="cython line score-0">&#xA0;<span class="">420</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">421</span>: 								if ala[q] == atom:</pre>
<pre class='cython code score-0 '>                __pyx_t_36 = __pyx_v_q;
                __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_36 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
                if (__pyx_t_7) {
/* … */
                }
              }
            }
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>: 									sj -= clmbsfx([alo_a[p,0], alo_a[p,1], alo_a[p,2]], [alo_a[q,0], alo_a[q,1], alo_a[q,2]],  \</pre>
<pre class='cython code score-0 '>                  __pyx_t_36 = __pyx_v_p;
                  __pyx_t_35 = 0;
                  __pyx_t_33 = __pyx_v_p;
                  __pyx_t_16 = 1;
                  __pyx_t_15 = __pyx_v_p;
                  __pyx_t_37 = 2;
                  __pyx_t_91[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_36 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_91[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_33 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_91[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_15 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_37 = __pyx_v_q;
                  __pyx_t_15 = 0;
                  __pyx_t_16 = __pyx_v_q;
                  __pyx_t_33 = 1;
                  __pyx_t_35 = __pyx_v_q;
                  __pyx_t_36 = 2;
                  __pyx_t_92[0] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_37 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_92[1] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_16 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_a.strides[1]) )));
                  __pyx_t_92[2] = (*((short *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_a.data + __pyx_t_35 * __pyx_v_alo_a.strides[0]) ) + __pyx_t_36 * __pyx_v_alo_a.strides[1]) )));
/* … */
                  __pyx_v_sj = (__pyx_v_sj - ((__pyx_f_7ocypete_clmbsfx(__pyx_t_91, __pyx_t_92, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_36 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_35 * __pyx_v_alo_e.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_e.data + __pyx_t_33 * __pyx_v_alo_e.strides[0]) ) + __pyx_t_16 * __pyx_v_alo_e.strides[1]) ))), __pyx_t_93, __pyx_t_94, __pyx_t_79, __pyx_t_95, __pyx_t_96, __pyx_v_cart, 1) * __pyx_v_f) * (*((short *) ( /* dim=0 */ (__pyx_v_alo_z.data + __pyx_t_15 * __pyx_v_alo_z.strides[0]) )))));
                  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_79, 1);
                  __pyx_t_79.memview = NULL;
                  __pyx_t_79.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">423</span>:  						                    alo_e[p,i], alo_e[q,j], [alo_o[p,0], alo_o[p,1], alo_o[p,2]], [alo_o[q,0], alo_o[q,1], alo_o[q,2]], \</pre>
<pre class='cython code score-0 '>                  __pyx_t_36 = __pyx_v_p;
                  __pyx_t_35 = __pyx_v_i;
                  __pyx_t_33 = __pyx_v_q;
                  __pyx_t_16 = __pyx_v_j;
                  __pyx_t_15 = __pyx_v_p;
                  __pyx_t_37 = 0;
                  __pyx_t_38 = __pyx_v_p;
                  __pyx_t_34 = 1;
                  __pyx_t_39 = __pyx_v_p;
                  __pyx_t_40 = 2;
                  __pyx_t_93[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_15 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_93[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_38 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_34 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_93[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_39 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_40 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_40 = __pyx_v_q;
                  __pyx_t_39 = 0;
                  __pyx_t_34 = __pyx_v_q;
                  __pyx_t_38 = 1;
                  __pyx_t_37 = __pyx_v_q;
                  __pyx_t_15 = 2;
                  __pyx_t_94[0] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_40 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_39 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_94[1] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_34 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_o.strides[1]) )));
                  __pyx_t_94[2] = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_o.data + __pyx_t_37 * __pyx_v_alo_o.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_o.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">424</span>:  						                    alo_x[r], [0,0,0], [0,0,0], cart, 1  ) * f * alo_z[r]</pre>
<pre class='cython code score-0 '>                  __pyx_t_79.data = __pyx_v_alo_x.data;
                  __pyx_t_79.memview = __pyx_v_alo_x.memview;
                  __PYX_INC_MEMVIEW(&amp;__pyx_t_79, 0);
                  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_r;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_alo_x.strides[0];
        __pyx_t_79.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_79.shape[0] = __pyx_v_alo_x.shape[1];
__pyx_t_79.strides[0] = __pyx_v_alo_x.strides[1];
    __pyx_t_79.suboffsets[0] = -1;

__pyx_t_95[0] = 0;
                  __pyx_t_95[1] = 0;
                  __pyx_t_95[2] = 0;
                  __pyx_t_96[0] = 0.0;
                  __pyx_t_96[1] = 0.0;
                  __pyx_t_96[2] = 0.0;
/* … */
                  __pyx_t_15 = __pyx_v_r;
</pre><pre class="cython line score-0">&#xA0;<span class="">425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">427</span>: 					oeifx[p,q] = oeifx[q,p] = sk + sj + sh</pre>
<pre class='cython code score-0 '>          __pyx_t_14 = ((__pyx_v_sk + __pyx_v_sj) + __pyx_v_sh);
          __pyx_t_15 = __pyx_v_p;
          __pyx_t_16 = __pyx_v_q;
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oeifx.data + __pyx_t_15 * __pyx_v_oeifx.strides[0]) ) + __pyx_t_16 * __pyx_v_oeifx.strides[1]) )) = __pyx_t_14;
          __pyx_t_16 = __pyx_v_q;
          __pyx_t_15 = __pyx_v_p;
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oeifx.data + __pyx_t_16 * __pyx_v_oeifx.strides[0]) ) + __pyx_t_15 * __pyx_v_oeifx.strides[1]) )) = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">428</span>: 					overlapfx[p,q] = overlapfx[q,p] = ss</pre>
<pre class='cython code score-0 '>          __pyx_t_15 = __pyx_v_p;
          __pyx_t_16 = __pyx_v_q;
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_overlapfx.data + __pyx_t_15 * __pyx_v_overlapfx.strides[0]) ) + __pyx_t_16 * __pyx_v_overlapfx.strides[1]) )) = __pyx_v_ss;
          __pyx_t_16 = __pyx_v_q;
          __pyx_t_15 = __pyx_v_p;
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_overlapfx.data + __pyx_t_16 * __pyx_v_overlapfx.strides[0]) ) + __pyx_t_15 * __pyx_v_overlapfx.strides[1]) )) = __pyx_v_ss;
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">429</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">430</span>: 	#----------------------------------------End one electron--------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">431</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>: 	#---------------------------------------Begin two electron-------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">434</span>: 			for p in range(0, nb):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_nb;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_p = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">435</span>: 				for q in range(0, p+1):</pre>
<pre class='cython code score-0 '>        __pyx_t_25 = (__pyx_v_p + 1);
        __pyx_t_26 = __pyx_t_25;
        for (__pyx_t_27 = 0; __pyx_t_27 &lt; __pyx_t_26; __pyx_t_27+=1) {
          __pyx_v_q = __pyx_t_27;
</pre><pre class="cython line score-0">&#xA0;<span class="">436</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">437</span>: 					si = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_v_si = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">438</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">439</span>: 					i = p*(p+1)//2 + q</pre>
<pre class='cython code score-0 '>          __pyx_v_i = (((__pyx_v_p * (__pyx_v_p + 1)) / 2) + __pyx_v_q);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">440</span>: 					for r in range(0, nb):</pre>
<pre class='cython code score-0 '>          __pyx_t_29 = __pyx_v_nb;
          __pyx_t_32 = __pyx_t_29;
          for (__pyx_t_82 = 0; __pyx_t_82 &lt; __pyx_t_32; __pyx_t_82+=1) {
            __pyx_v_r = __pyx_t_82;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">441</span>: 						for s in range(0, r+1):</pre>
<pre class='cython code score-0 '>            __pyx_t_97 = (__pyx_v_r + 1);
            __pyx_t_98 = __pyx_t_97;
            for (__pyx_t_83 = 0; __pyx_t_83 &lt; __pyx_t_98; __pyx_t_83+=1) {
              __pyx_v_s = __pyx_t_83;
</pre><pre class="cython line score-0">&#xA0;<span class="">442</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">443</span>: 							j = r*(r+1)//2 + s</pre>
<pre class='cython code score-0 '>              __pyx_v_j = (((__pyx_v_r * (__pyx_v_r + 1)) / 2) + __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">444</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">445</span>: 							if i &gt;= j:</pre>
<pre class='cython code score-0 '>              __pyx_t_7 = ((__pyx_v_i &gt;= __pyx_v_j) != 0);
              if (__pyx_t_7) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">446</span>: 								si = 0.0</pre>
<pre class='cython code score-0 '>                __pyx_v_si = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">447</span>: 								if ala[p] == atom:</pre>
<pre class='cython code score-0 '>                __pyx_t_15 = __pyx_v_p;
                __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_15 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
                if (__pyx_t_7) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">448</span>: 									si += erifx(alo , p ,q ,r ,s ,alo_n ,alo_c ,alo_e ,alo_a , alo_o, cart, 0)</pre>
<pre class='cython code score-0 '>                  __pyx_v_si = (__pyx_v_si + __pyx_f_7ocypete_erifx(__pyx_v_alo, __pyx_v_p, __pyx_v_q, __pyx_v_r, __pyx_v_s, __pyx_v_alo_n, __pyx_v_alo_c, __pyx_v_alo_e, __pyx_v_alo_a, __pyx_v_alo_o, __pyx_v_cart, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">449</span>: 								if ala[q] == atom:</pre>
<pre class='cython code score-0 '>                __pyx_t_15 = __pyx_v_q;
                __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_15 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
                if (__pyx_t_7) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">450</span>: 									si += erifx(alo , p ,q ,r ,s ,alo_n ,alo_c ,alo_e ,alo_a , alo_o, cart, 1)</pre>
<pre class='cython code score-0 '>                  __pyx_v_si = (__pyx_v_si + __pyx_f_7ocypete_erifx(__pyx_v_alo, __pyx_v_p, __pyx_v_q, __pyx_v_r, __pyx_v_s, __pyx_v_alo_n, __pyx_v_alo_c, __pyx_v_alo_e, __pyx_v_alo_a, __pyx_v_alo_o, __pyx_v_cart, 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>: 								if ala[r] == atom:</pre>
<pre class='cython code score-0 '>                __pyx_t_15 = __pyx_v_r;
                __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_15 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
                if (__pyx_t_7) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>: 									si += erifx(alo , p ,q ,r ,s ,alo_n ,alo_c ,alo_e ,alo_a , alo_o, cart, 2)</pre>
<pre class='cython code score-0 '>                  __pyx_v_si = (__pyx_v_si + __pyx_f_7ocypete_erifx(__pyx_v_alo, __pyx_v_p, __pyx_v_q, __pyx_v_r, __pyx_v_s, __pyx_v_alo_n, __pyx_v_alo_c, __pyx_v_alo_e, __pyx_v_alo_a, __pyx_v_alo_o, __pyx_v_cart, 2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>: 								if ala[s] == atom:</pre>
<pre class='cython code score-0 '>                __pyx_t_15 = __pyx_v_s;
                __pyx_t_7 = (((*((short *) ( /* dim=0 */ (__pyx_v_ala.data + __pyx_t_15 * __pyx_v_ala.strides[0]) ))) == __pyx_v_atom) != 0);
                if (__pyx_t_7) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>: 									si += erifx(alo , p ,q ,r ,s ,alo_n ,alo_c ,alo_e ,alo_a , alo_o, cart, 3)</pre>
<pre class='cython code score-0 '>                  __pyx_v_si = (__pyx_v_si + __pyx_f_7ocypete_erifx(__pyx_v_alo, __pyx_v_p, __pyx_v_q, __pyx_v_r, __pyx_v_s, __pyx_v_alo_n, __pyx_v_alo_c, __pyx_v_alo_e, __pyx_v_alo_a, __pyx_v_alo_o, __pyx_v_cart, 3));
</pre><pre class="cython line score-0">&#xA0;<span class="">455</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">456</span>: 							teifx[p,q,r,s] = teifx[p,q,s,r] = teifx[q,p,s,r] = teifx[q,p,r,s] = \</pre>
<pre class='cython code score-0 '>              __pyx_t_15 = __pyx_v_p;
              __pyx_t_16 = __pyx_v_q;
              __pyx_t_33 = __pyx_v_r;
              __pyx_t_35 = __pyx_v_s;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_15 * __pyx_v_teifx.strides[0]) ) + __pyx_t_16 * __pyx_v_teifx.strides[1]) ) + __pyx_t_33 * __pyx_v_teifx.strides[2]) ) + __pyx_t_35 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
              __pyx_t_35 = __pyx_v_p;
              __pyx_t_33 = __pyx_v_q;
              __pyx_t_16 = __pyx_v_s;
              __pyx_t_15 = __pyx_v_r;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_35 * __pyx_v_teifx.strides[0]) ) + __pyx_t_33 * __pyx_v_teifx.strides[1]) ) + __pyx_t_16 * __pyx_v_teifx.strides[2]) ) + __pyx_t_15 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
              __pyx_t_15 = __pyx_v_q;
              __pyx_t_16 = __pyx_v_p;
              __pyx_t_33 = __pyx_v_s;
              __pyx_t_35 = __pyx_v_r;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_15 * __pyx_v_teifx.strides[0]) ) + __pyx_t_16 * __pyx_v_teifx.strides[1]) ) + __pyx_t_33 * __pyx_v_teifx.strides[2]) ) + __pyx_t_35 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
              __pyx_t_35 = __pyx_v_q;
              __pyx_t_33 = __pyx_v_p;
              __pyx_t_16 = __pyx_v_r;
              __pyx_t_15 = __pyx_v_s;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_35 * __pyx_v_teifx.strides[0]) ) + __pyx_t_33 * __pyx_v_teifx.strides[1]) ) + __pyx_t_16 * __pyx_v_teifx.strides[2]) ) + __pyx_t_15 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>: 							teifx[r,s,p,q] = teifx[r,s,q,p] = teifx[s,r,q,p] = teifx[s,r,p,q] = si</pre>
<pre class='cython code score-0 '>              __pyx_t_15 = __pyx_v_r;
              __pyx_t_16 = __pyx_v_s;
              __pyx_t_33 = __pyx_v_p;
              __pyx_t_35 = __pyx_v_q;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_15 * __pyx_v_teifx.strides[0]) ) + __pyx_t_16 * __pyx_v_teifx.strides[1]) ) + __pyx_t_33 * __pyx_v_teifx.strides[2]) ) + __pyx_t_35 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
              __pyx_t_35 = __pyx_v_r;
              __pyx_t_33 = __pyx_v_s;
              __pyx_t_16 = __pyx_v_q;
              __pyx_t_15 = __pyx_v_p;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_35 * __pyx_v_teifx.strides[0]) ) + __pyx_t_33 * __pyx_v_teifx.strides[1]) ) + __pyx_t_16 * __pyx_v_teifx.strides[2]) ) + __pyx_t_15 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
              __pyx_t_15 = __pyx_v_s;
              __pyx_t_16 = __pyx_v_r;
              __pyx_t_33 = __pyx_v_q;
              __pyx_t_35 = __pyx_v_p;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_15 * __pyx_v_teifx.strides[0]) ) + __pyx_t_16 * __pyx_v_teifx.strides[1]) ) + __pyx_t_33 * __pyx_v_teifx.strides[2]) ) + __pyx_t_35 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
              __pyx_t_35 = __pyx_v_s;
              __pyx_t_33 = __pyx_v_r;
              __pyx_t_16 = __pyx_v_p;
              __pyx_t_15 = __pyx_v_q;
              *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_35 * __pyx_v_teifx.strides[0]) ) + __pyx_t_33 * __pyx_v_teifx.strides[1]) ) + __pyx_t_16 * __pyx_v_teifx.strides[2]) ) + __pyx_t_15 * __pyx_v_teifx.strides[3]) )) = __pyx_v_si;
            }
          }
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">459</span>: 	#----------------------------------------End two electron--------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">460</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">461</span>: 	#-------------------------------------------build Fock-----------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">462</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">463</span>: 			for p in range(0, nb):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_nb;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_p = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">464</span>: 				for q in range(0, nb):</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_nb;
        __pyx_t_29 = __pyx_t_27;
        for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_29; __pyx_t_32+=1) {
          __pyx_v_q = __pyx_t_32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>: 					sf = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_v_sf = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>: 					for r in range(0, nb):</pre>
<pre class='cython code score-0 '>          __pyx_t_82 = __pyx_v_nb;
          __pyx_t_83 = __pyx_t_82;
          for (__pyx_t_84 = 0; __pyx_t_84 &lt; __pyx_t_83; __pyx_t_84+=1) {
            __pyx_v_r = __pyx_t_84;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>: 						for s in range(0, nb):</pre>
<pre class='cython code score-0 '>            __pyx_t_99 = __pyx_v_nb;
            __pyx_t_100 = __pyx_t_99;
            for (__pyx_t_101 = 0; __pyx_t_101 &lt; __pyx_t_100; __pyx_t_101+=1) {
              __pyx_v_s = __pyx_t_101;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>: 							sf += (2.0 * teifx[p,q,r,s] - teifx[p,s,q,r]) * density[s,r]</pre>
<pre class='cython code score-0 '>              __pyx_t_15 = __pyx_v_p;
              __pyx_t_16 = __pyx_v_q;
              __pyx_t_33 = __pyx_v_r;
              __pyx_t_35 = __pyx_v_s;
              __pyx_t_36 = __pyx_v_p;
              __pyx_t_37 = __pyx_v_s;
              __pyx_t_38 = __pyx_v_q;
              __pyx_t_34 = __pyx_v_r;
              __pyx_t_39 = __pyx_v_s;
              __pyx_t_40 = __pyx_v_r;
              __pyx_v_sf = (__pyx_v_sf + (((2.0 * (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_15 * __pyx_v_teifx.strides[0]) ) + __pyx_t_16 * __pyx_v_teifx.strides[1]) ) + __pyx_t_33 * __pyx_v_teifx.strides[2]) ) + __pyx_t_35 * __pyx_v_teifx.strides[3]) )))) - (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_teifx.data + __pyx_t_36 * __pyx_v_teifx.strides[0]) ) + __pyx_t_37 * __pyx_v_teifx.strides[1]) ) + __pyx_t_38 * __pyx_v_teifx.strides[2]) ) + __pyx_t_34 * __pyx_v_teifx.strides[3]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_density.data + __pyx_t_39 * __pyx_v_density.strides[0]) ) + __pyx_t_40 * __pyx_v_density.strides[1]) )))));
            }
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">469</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>: 					fockfx[p,q] = oeifx[p,q] + sf</pre>
<pre class='cython code score-0 '>          __pyx_t_40 = __pyx_v_p;
          __pyx_t_39 = __pyx_v_q;
          __pyx_t_34 = __pyx_v_p;
          __pyx_t_38 = __pyx_v_q;
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_fockfx.data + __pyx_t_34 * __pyx_v_fockfx.strides[0]) ) + __pyx_t_38 * __pyx_v_fockfx.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oeifx.data + __pyx_t_40 * __pyx_v_oeifx.strides[0]) ) + __pyx_t_39 * __pyx_v_oeifx.strides[1]) ))) + __pyx_v_sf);
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">471</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">472</span>: 	#|----------------------------------------build energy-----------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">473</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>: 			force = 0.0</pre>
<pre class='cython code score-0 '>      __pyx_v_force = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">475</span>: 			for p in range(0, nb):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_nb;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_p = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>: 				for q in range(0, nb):</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_nb;
        __pyx_t_29 = __pyx_t_27;
        for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_29; __pyx_t_32+=1) {
          __pyx_v_q = __pyx_t_32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>: 					force -= density[p,q] * (fockfx[q,p] + oeifx[q,p])</pre>
<pre class='cython code score-0 '>          __pyx_t_39 = __pyx_v_p;
          __pyx_t_40 = __pyx_v_q;
          __pyx_t_38 = __pyx_v_q;
          __pyx_t_34 = __pyx_v_p;
          __pyx_t_37 = __pyx_v_q;
          __pyx_t_36 = __pyx_v_p;
          __pyx_v_force = (__pyx_v_force - ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_density.data + __pyx_t_39 * __pyx_v_density.strides[0]) ) + __pyx_t_40 * __pyx_v_density.strides[1]) ))) * ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_fockfx.data + __pyx_t_38 * __pyx_v_fockfx.strides[0]) ) + __pyx_t_34 * __pyx_v_fockfx.strides[1]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oeifx.data + __pyx_t_37 * __pyx_v_oeifx.strides[0]) ) + __pyx_t_36 * __pyx_v_oeifx.strides[1]) ))))));
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">479</span>: 	#|-----------------------------------density weighted energy-----------------------------------|</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>: 			for p in range(0, nb):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_nb;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_p = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">481</span>: 				for q in range(0, nb):</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_nb;
        __pyx_t_29 = __pyx_t_27;
        for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_29; __pyx_t_32+=1) {
          __pyx_v_q = __pyx_t_32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>: 					energy[p,q] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_36 = __pyx_v_p;
          __pyx_t_37 = __pyx_v_q;
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_energy.data + __pyx_t_36 * __pyx_v_energy.strides[0]) ) + __pyx_t_37 * __pyx_v_energy.strides[1]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>: 					for r in range(0, nb):</pre>
<pre class='cython code score-0 '>          __pyx_t_82 = __pyx_v_nb;
          __pyx_t_83 = __pyx_t_82;
          for (__pyx_t_84 = 0; __pyx_t_84 &lt; __pyx_t_83; __pyx_t_84+=1) {
            __pyx_v_r = __pyx_t_84;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>: 						energy[p,q] += fock[p,r] * density[r,q]</pre>
<pre class='cython code score-0 '>            __pyx_t_37 = __pyx_v_p;
            __pyx_t_36 = __pyx_v_r;
            __pyx_t_34 = __pyx_v_r;
            __pyx_t_38 = __pyx_v_q;
            __pyx_t_40 = __pyx_v_p;
            __pyx_t_39 = __pyx_v_q;
            *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_energy.data + __pyx_t_40 * __pyx_v_energy.strides[0]) ) + __pyx_t_39 * __pyx_v_energy.strides[1]) )) += ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_fock.data + __pyx_t_37 * __pyx_v_fock.strides[0]) ) + __pyx_t_36 * __pyx_v_fock.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_density.data + __pyx_t_34 * __pyx_v_density.strides[0]) ) + __pyx_t_38 * __pyx_v_density.strides[1]) ))));
          }
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>: 			for p in range(0, nb):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_nb;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_p = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>: 				for q in range(0, nb):</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_nb;
        __pyx_t_29 = __pyx_t_27;
        for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_29; __pyx_t_32+=1) {
          __pyx_v_q = __pyx_t_32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">487</span>: 					weightedEnergy[p,q] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_38 = __pyx_v_p;
          __pyx_t_34 = __pyx_v_q;
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_weightedEnergy.data + __pyx_t_38 * __pyx_v_weightedEnergy.strides[0]) ) + __pyx_t_34 * __pyx_v_weightedEnergy.strides[1]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>: 					for r in range(0, nb):</pre>
<pre class='cython code score-0 '>          __pyx_t_82 = __pyx_v_nb;
          __pyx_t_83 = __pyx_t_82;
          for (__pyx_t_84 = 0; __pyx_t_84 &lt; __pyx_t_83; __pyx_t_84+=1) {
            __pyx_v_r = __pyx_t_84;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>: 						weightedEnergy[p,q] += density[p,r] * energy[r,q]</pre>
<pre class='cython code score-0 '>            __pyx_t_34 = __pyx_v_p;
            __pyx_t_38 = __pyx_v_r;
            __pyx_t_36 = __pyx_v_r;
            __pyx_t_37 = __pyx_v_q;
            __pyx_t_39 = __pyx_v_p;
            __pyx_t_40 = __pyx_v_q;
            *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_weightedEnergy.data + __pyx_t_39 * __pyx_v_weightedEnergy.strides[0]) ) + __pyx_t_40 * __pyx_v_weightedEnergy.strides[1]) )) += ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_density.data + __pyx_t_34 * __pyx_v_density.strides[0]) ) + __pyx_t_38 * __pyx_v_density.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_energy.data + __pyx_t_36 * __pyx_v_energy.strides[0]) ) + __pyx_t_37 * __pyx_v_energy.strides[1]) ))));
          }
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">490</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">491</span>: 	#|-------------------------------------overlap contribution------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">492</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">493</span>: 			for p in range(0, nb):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_nb;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_p = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>: 				for q in range(0, nb):</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_nb;
        __pyx_t_29 = __pyx_t_27;
        for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_29; __pyx_t_32+=1) {
          __pyx_v_q = __pyx_t_32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">495</span>: 					force += 2.0 * overlapfx[p,q] * weightedEnergy[q,p]</pre>
<pre class='cython code score-0 '>          __pyx_t_37 = __pyx_v_p;
          __pyx_t_36 = __pyx_v_q;
          __pyx_t_38 = __pyx_v_q;
          __pyx_t_34 = __pyx_v_p;
          __pyx_v_force = (__pyx_v_force + ((2.0 * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_overlapfx.data + __pyx_t_37 * __pyx_v_overlapfx.strides[0]) ) + __pyx_t_36 * __pyx_v_overlapfx.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_weightedEnergy.data + __pyx_t_38 * __pyx_v_weightedEnergy.strides[0]) ) + __pyx_t_34 * __pyx_v_weightedEnergy.strides[1]) )))));
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">497</span>: 	#|---------------------------------------nuclear repulsion-------------------------------------|</pre>
<pre class="cython line score-0">&#xA0;<span class="">498</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">499</span>: 			for i in range(0, na):</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_na;
      __pyx_t_23 = __pyx_t_13;
      for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
        __pyx_v_i = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>: 				ra = sqrt((alo_x[atom,0] - alo_x[i,0])*(alo_x[atom,0] - alo_x[i,0]) + (alo_x[atom,1] - alo_x[i,1])*(alo_x[atom,1] - alo_x[i,1]) + \</pre>
<pre class='cython code score-0 '>        __pyx_t_34 = __pyx_v_atom;
        __pyx_t_38 = 0;
        __pyx_t_36 = __pyx_v_i;
        __pyx_t_37 = 0;
        __pyx_t_40 = __pyx_v_atom;
        __pyx_t_39 = 0;
        __pyx_t_35 = __pyx_v_i;
        __pyx_t_33 = 0;
        __pyx_t_16 = __pyx_v_atom;
        __pyx_t_15 = 1;
        __pyx_t_41 = __pyx_v_i;
        __pyx_t_42 = 1;
        __pyx_t_43 = __pyx_v_atom;
        __pyx_t_44 = 1;
        __pyx_t_45 = __pyx_v_i;
        __pyx_t_46 = 1;
/* … */
        __pyx_v_ra = sqrt((((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_34 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_38 * __pyx_v_alo_x.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_36 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_37 * __pyx_v_alo_x.strides[1]) )))) * ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_40 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_39 * __pyx_v_alo_x.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_35 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_33 * __pyx_v_alo_x.strides[1]) ))))) + (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_16 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_15 * __pyx_v_alo_x.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_41 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_42 * __pyx_v_alo_x.strides[1]) )))) * ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_43 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_44 * __pyx_v_alo_x.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_45 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_46 * __pyx_v_alo_x.strides[1]) )))))) + (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_47 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_48 * __pyx_v_alo_x.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_49 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_50 * __pyx_v_alo_x.strides[1]) )))) * ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_51 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_52 * __pyx_v_alo_x.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_53 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_54 * __pyx_v_alo_x.strides[1]) )))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>: 					     (alo_x[atom,2] - alo_x[i,2])*(alo_x[atom,2] - alo_x[i,2]))</pre>
<pre class='cython code score-0 '>        __pyx_t_47 = __pyx_v_atom;
        __pyx_t_48 = 2;
        __pyx_t_49 = __pyx_v_i;
        __pyx_t_50 = 2;
        __pyx_t_51 = __pyx_v_atom;
        __pyx_t_52 = 2;
        __pyx_t_53 = __pyx_v_i;
        __pyx_t_54 = 2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">502</span>: 				rb = alo_x[atom,cart] - alo_x[i,cart]</pre>
<pre class='cython code score-0 '>        __pyx_t_54 = __pyx_v_atom;
        __pyx_t_53 = __pyx_v_cart;
        __pyx_t_52 = __pyx_v_i;
        __pyx_t_51 = __pyx_v_cart;
        __pyx_v_rb = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_54 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_53 * __pyx_v_alo_x.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_alo_x.data + __pyx_t_52 * __pyx_v_alo_x.strides[0]) ) + __pyx_t_51 * __pyx_v_alo_x.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">503</span>: 				if ra != 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = ((__pyx_v_ra != 0.0) != 0);
        if (__pyx_t_7) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">504</span>: 					force += rb * alo_z[i] * alo_z[atom]/(ra*ra*ra)</pre>
<pre class='cython code score-0 '>          __pyx_t_51 = __pyx_v_i;
          __pyx_t_52 = __pyx_v_atom;
          __pyx_v_force = (__pyx_v_force + (((__pyx_v_rb * (*((short *) ( /* dim=0 */ (__pyx_v_alo_z.data + __pyx_t_51 * __pyx_v_alo_z.strides[0]) )))) * (*((short *) ( /* dim=0 */ (__pyx_v_alo_z.data + __pyx_t_52 * __pyx_v_alo_z.strides[0]) )))) / ((__pyx_v_ra * __pyx_v_ra) * __pyx_v_ra)));
</pre><pre class="cython line score-0">&#xA0;<span class="">505</span>: 	#|------------------------------------------final forces---------------------------------------|</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>: 			if abs(force) &gt; 1e-12:</pre>
<pre class='cython code score-0 '>      __pyx_t_7 = ((fabs(__pyx_v_force) &gt; 1e-12) != 0);
      if (__pyx_t_7) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>: 				vires[atom,cart] = force</pre>
<pre class='cython code score-0 '>        __pyx_t_52 = __pyx_v_atom;
        __pyx_t_51 = __pyx_v_cart;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vires.data + __pyx_t_52 * __pyx_v_vires.strides[0]) ) + __pyx_t_51 * __pyx_v_vires.strides[1]) )) = __pyx_v_force;
</pre><pre class="cython line score-0">&#xA0;<span class="">508</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>: 	return Vx</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Vx);
  __pyx_r = __pyx_v_Vx;
  goto __pyx_L0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>: import time</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_time, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 510, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">511</span>: import rhf</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rhf, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rhf, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-80" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>: a , b, d = rhf.mol([])</pre>
<pre class='cython code score-80 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_rhf);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_mol);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_1 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L2_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L2_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L2_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L3_unpacking_done;
    __pyx_L2_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
    __pyx_L3_unpacking_done:;
  }
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_a, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_b, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_d, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>: from numpy import load</pre>
<pre class='cython code score-19 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_load);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_load);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_load);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_load, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>: data = load('../mints/h2o-sto-3g-mints.npz')</pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_data, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_mints_h2o_sto_3g_mints_npz);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">515</span>: d = data['d']</pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_3, __pyx_n_u_d);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_d, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>: f = data['f']</pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_4, __pyx_n_u_f);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_f, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">517</span>: tt = time.time()</pre>
<pre class='cython code score-14 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 517, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 517, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 517, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_tt, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 517, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">518</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">519</span>: v= ocypete(a,b,d,f)</pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_a);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_b);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_f);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_7ocypete_ocypete(__pyx_t_3, __pyx_t_4, __pyx_t_7, __pyx_t_8, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_v, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 519, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">520</span>: print(v)</pre>
<pre class='cython code score-6 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_v);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">521</span>: print(time.time()-tt)</pre>
<pre class='cython code score-21 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_tt);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre></div></body></html>
